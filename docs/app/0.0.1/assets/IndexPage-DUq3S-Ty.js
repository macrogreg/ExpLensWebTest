var gn=Object.defineProperty;var ra=e=>{throw TypeError(e)};var mn=(e,t,a)=>t in e?gn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var Ne=(e,t,a)=>mn(e,typeof t!="symbol"?t+"":t,a),pn=(e,t,a)=>t.has(e)||ra("Cannot "+a);var ye=(e,t,a)=>(pn(e,t,"read from private field"),a?a.call(e):t.get(e)),Et=(e,t,a)=>t.has(e)?ra("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,a);import{c as ve,g as ge,r as B,a as O,w as J,o as Ce,W as at,X as Ue,h as M,T as ot,b as fe,v as Be,i as bt,e as Ae,Y as $a,m as Qe,K as Ut,Z as vn,Q as Te,j as hn,_ as yn,$ as La,a0 as Ma,a1 as Fa,p as bn,a2 as wn,a3 as pe,a4 as Pt,n as _n,t as la,a5 as Tn,a6 as Cn,a7 as Sn,a8 as kn,l as An,d as xn,a9 as Rn,aa as En,ab as ia,k as Oe,ac as Pn,u as In,ad as qn,ae as On,af as $n,ag as Va,U as Fe,ah as Ge,ai as Ln,A as ua,aj as Mn,B as kt,q as Fn,D as we,E as de,I as H,H as K,F as Ee,ak as ce,G as be,J as te,L as ie,z as Pe,O as Vn,M as mt,S as Bn}from"./index-C46hz2fF.js";import{k as pt,i as Ba,s as Dn,v as zn,j as ca,l as Da,Y as Nn,x as da,n as nt,o as st,p as za,q as Un,r as Hn,t as Na,w as Ua,z as jn,B as fa,F as Kn,Z as Ht,g as Qn,Q as Wn,f as Gt,h as Yt,u as Gn,d as Yn,e as Xn,b as Zn,a as Jn,$ as eo,C as to,y as ao,D as ga,A as ma,G as Xt,H as no,a0 as oo,a1 as so,a2 as ro,J as De,a3 as xe,a4 as ae,a5 as Zt,a6 as he,a7 as lo,a8 as io,a9 as uo,aa as ut,ab as co,N as fo,O as go,ac as jt,ad as mo,X as pa,ae as Ye,U as po,P as vo,_ as ho}from"./_plugin-vue_export-helper-D2C_QfjW.js";const je=ve({name:"QTooltip",inheritAttrs:!1,props:{...Nn,...Da,...pt,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...pt.transitionShow,default:"jump-down"},transitionHide:{...pt.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:ca},self:{type:String,default:"top middle",validator:ca},offset:{type:Array,default:()=>[14,14],validator:zn},scrollTarget:Dn,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...Ba],setup(e,{slots:t,emit:a,attrs:n}){let s,o;const r=ge(),{proxy:{$q:l}}=r,d=B(null),c=B(!1),w=O(()=>da(e.anchor,l.lang.rtl)),T=O(()=>da(e.self,l.lang.rtl)),y=O(()=>e.persistent!==!0),{registerTick:k,removeTick:I}=nt(),{registerTimeout:L}=st(),{transitionProps:A,transitionStyle:N}=za(e),{localScrollTarget:Q,changeScrollEvent:$,unconfigureScrollTarget:v}=Un(e,le),{anchorEl:C,canShow:f,anchorEvents:x}=Hn({showing:c,configureAnchorEl:F}),{show:q,hide:z}=Na({showing:c,canShow:f,handleShow:S,handleHide:u,hideOnRouteChange:y,processOnMount:!0});Object.assign(x,{delayShow:E,delayHide:h});const{showPortal:m,hidePortal:g,renderPortal:R}=Ua(r,d,b,"tooltip");if(l.platform.is.mobile===!0){const U={anchorEl:C,innerRef:d,onClickOutside(ne){return z(ne),ne.target.classList.contains("q-dialog__backdrop")&&Be(ne),!0}},ee=O(()=>e.modelValue===null&&e.persistent!==!0&&c.value===!0);J(ee,ne=>{(ne===!0?jn:fa)(U)}),Ce(()=>{fa(U)})}function S(U){m(),k(()=>{o=new MutationObserver(()=>_()),o.observe(d.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),_(),le()}),s===void 0&&(s=J(()=>l.screen.width+"|"+l.screen.height+"|"+e.self+"|"+e.anchor+"|"+l.lang.rtl,_)),L(()=>{m(!0),a("show",U)},e.transitionDuration)}function u(U){I(),g(),i(),L(()=>{g(!0),a("hide",U)},e.transitionDuration)}function i(){o!==void 0&&(o.disconnect(),o=void 0),s!==void 0&&(s(),s=void 0),v(),at(x,"tooltipTemp")}function _(){Kn({targetEl:d.value,offset:e.offset,anchorEl:C.value,anchorOrigin:w.value,selfOrigin:T.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function E(U){if(l.platform.is.mobile===!0){Ht(),document.body.classList.add("non-selectable");const ee=C.value,ne=["touchmove","touchcancel","touchend","click"].map(D=>[ee,D,"delayHide","passiveCapture"]);Ue(x,"tooltipTemp",ne)}L(()=>{q(U)},e.delay)}function h(U){l.platform.is.mobile===!0&&(at(x,"tooltipTemp"),Ht(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),L(()=>{z(U)},e.hideDelay)}function F(){if(e.noParentEvent===!0||C.value===null)return;const U=l.platform.is.mobile===!0?[[C.value,"touchstart","delayShow","passive"]]:[[C.value,"mouseenter","delayShow","passive"],[C.value,"mouseleave","delayHide","passive"]];Ue(x,"anchor",U)}function le(){if(C.value!==null||e.scrollTarget!==void 0){Q.value=Qn(C.value,e.scrollTarget);const U=e.noParentEvent===!0?_:z;$(Q.value,U)}}function j(){return c.value===!0?M("div",{...n,ref:d,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",n.class],style:[n.style,N.value],role:"tooltip"},fe(t.default)):null}function b(){return M(ot,A.value,j)}return Ce(i),Object.assign(r.proxy,{updatePosition:_}),R}});let yo=0;const bo=["click","keydown"],wo={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${yo++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function _o(e,t,a,n){const s=bt($a,Ae);if(s===Ae)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Ae;const{proxy:o}=ge(),r=B(null),l=B(null),d=B(null),c=O(()=>e.disable===!0||e.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},e.ripple===!0?{}:e.ripple)),w=O(()=>s.currentModel.value===e.name),T=O(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(w.value===!0?" q-tab--active"+(s.tabProps.value.activeClass?" "+s.tabProps.value.activeClass:"")+(s.tabProps.value.activeColor?` text-${s.tabProps.value.activeColor}`:"")+(s.tabProps.value.activeBgColor?` bg-${s.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&s.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(e.noCaps===!0||s.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(e.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")),y=O(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(s.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(e.contentClass!==void 0?` ${e.contentClass}`:"")),k=O(()=>e.disable===!0||s.hasFocus.value===!0||w.value===!1&&s.hasActiveTab.value===!0?-1:e.tabindex||0);function I($,v){if(v!==!0&&$?.qAvoidFocus!==!0&&r.value?.focus(),e.disable!==!0){s.updateModel({name:e.name}),a("click",$);return}}function L($){yn($,[13,32])?I($,!0):La($)!==!0&&$.keyCode>=35&&$.keyCode<=40&&$.altKey!==!0&&$.metaKey!==!0&&s.onKbdNavigate($.keyCode,o.$el)===!0&&Be($),a("keydown",$)}function A(){const $=s.tabProps.value.narrowIndicator,v=[],C=M("div",{ref:d,class:["q-tab__indicator",s.tabProps.value.indicatorClass]});e.icon!==void 0&&v.push(M(Te,{class:"q-tab__icon",name:e.icon})),e.label!==void 0&&v.push(M("div",{class:"q-tab__label"},e.label)),e.alert!==!1&&v.push(e.alertIcon!==void 0?M(Te,{class:"q-tab__alert-icon",color:e.alert!==!0?e.alert:void 0,name:e.alertIcon}):M("div",{class:"q-tab__alert"+(e.alert!==!0?` text-${e.alert}`:"")})),$===!0&&v.push(C);const f=[M("div",{class:"q-focus-helper",tabindex:-1,ref:r}),M("div",{class:y.value},hn(t.default,v))];return $===!1&&f.push(C),f}const N={name:O(()=>e.name),rootRef:l,tabIndicatorRef:d,routeData:n};Ce(()=>{s.unregisterTab(N)}),Qe(()=>{s.registerTab(N)});function Q($,v){const C={ref:l,class:T.value,tabindex:k.value,role:"tab","aria-selected":w.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:I,onKeydown:L,...v};return Ut(M($,C,A()),[[vn,c.value]])}return{renderTab:Q,$tabs:s}}const It=ve({name:"QTab",props:wo,emits:bo,setup(e,{slots:t,emit:a}){const{renderTab:n}=_o(e,t,a);return()=>n("div")}});let Ha=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const t=document.createElement("div");Object.assign(t.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(t),e.scrollLeft=-1e3,Ha=e.scrollLeft>=0,e.remove()}function To(e,t,a){const n=a===!0?["left","right"]:["top","bottom"];return`absolute-${t===!0?n[0]:n[1]}${e?` text-${e}`:""}`}const Co=["left","center","right","justify"],So=ve({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>Co.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:t,emit:a}){const{proxy:n}=ge(),{$q:s}=n,{registerTick:o}=nt(),{registerTick:r}=nt(),{registerTick:l}=nt(),{registerTimeout:d,removeTimeout:c}=st(),{registerTimeout:w,removeTimeout:T}=st(),y=B(null),k=B(null),I=B(e.modelValue),L=B(!1),A=B(!0),N=B(!1),Q=B(!1),$=[],v=B(0),C=B(!1);let f=null,x=null,q;const z=O(()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:To(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps})),m=O(()=>{const P=v.value,V=I.value;for(let W=0;W<P;W++)if($[W].name.value===V)return!0;return!1}),g=O(()=>`q-tabs__content--align-${L.value===!0?"left":Q.value===!0?"justify":e.align}`),R=O(()=>`q-tabs row no-wrap items-center q-tabs--${L.value===!0?"":"not-"}scrollable q-tabs--${e.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${e.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${e.mobileArrows===!0?"":"out"}-arrows`+(e.dense===!0?" q-tabs--dense":"")+(e.shrink===!0?" col-shrink":"")+(e.stretch===!0?" self-stretch":"")),S=O(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+g.value+(e.contentClass!==void 0?` ${e.contentClass}`:"")),u=O(()=>e.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),i=O(()=>e.vertical!==!0&&s.lang.rtl===!0),_=O(()=>Ha===!1&&i.value===!0);J(i,b),J(()=>e.modelValue,P=>{E({name:P,setCurrent:!0,skipEmit:!0})}),J(()=>e.outsideArrows,h);function E({name:P,setCurrent:V,skipEmit:W}){I.value!==P&&(W!==!0&&e["onUpdate:modelValue"]!==void 0&&a("update:modelValue",P),(V===!0||e["onUpdate:modelValue"]===void 0)&&(le(I.value,P),I.value=P))}function h(){o(()=>{y.value&&F({width:y.value.offsetWidth,height:y.value.offsetHeight})})}function F(P){if(u.value===void 0||k.value===null)return;const V=P[u.value.container],W=Math.min(k.value[u.value.scroll],Array.prototype.reduce.call(k.value.children,(se,Z)=>se+(Z[u.value.content]||0),0)),oe=V>0&&W>V;L.value=oe,oe===!0&&r(b),Q.value=V<parseInt(e.breakpoint,10)}function le(P,V){const W=P!=null&&P!==""?$.find(se=>se.name.value===P):null,oe=V!=null&&V!==""?$.find(se=>se.name.value===V):null;if(it===!0)it=!1;else if(W&&oe){const se=W.tabIndicatorRef.value,Z=oe.tabIndicatorRef.value;f!==null&&(clearTimeout(f),f=null),se.style.transition="none",se.style.transform="none",Z.style.transition="none",Z.style.transform="none";const X=se.getBoundingClientRect(),ue=Z.getBoundingClientRect();Z.style.transform=e.vertical===!0?`translate3d(0,${X.top-ue.top}px,0) scale3d(1,${ue.height?X.height/ue.height:1},1)`:`translate3d(${X.left-ue.left}px,0,0) scale3d(${ue.width?X.width/ue.width:1},1,1)`,l(()=>{f=setTimeout(()=>{f=null,Z.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",Z.style.transform="none"},70)})}oe&&L.value===!0&&j(oe.rootRef.value)}function j(P){const{left:V,width:W,top:oe,height:se}=k.value.getBoundingClientRect(),Z=P.getBoundingClientRect();let X=e.vertical===!0?Z.top-oe:Z.left-V;if(X<0){k.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(X),b();return}X+=e.vertical===!0?Z.height-se:Z.width-W,X>0&&(k.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(X),b())}function b(){const P=k.value;if(P===null)return;const V=P.getBoundingClientRect(),W=e.vertical===!0?P.scrollTop:Math.abs(P.scrollLeft);i.value===!0?(A.value=Math.ceil(W+V.width)<P.scrollWidth-1,N.value=W>0):(A.value=W>0,N.value=e.vertical===!0?Math.ceil(W+V.height)<P.scrollHeight:Math.ceil(W+V.width)<P.scrollWidth)}function U(P){x!==null&&clearInterval(x),x=setInterval(()=>{lt(P)===!0&&D()},5)}function ee(){U(_.value===!0?Number.MAX_SAFE_INTEGER:0)}function ne(){U(_.value===!0?0:Number.MAX_SAFE_INTEGER)}function D(){x!==null&&(clearInterval(x),x=null)}function G(P,V){const W=Array.prototype.filter.call(k.value.children,ue=>ue===V||ue.matches&&ue.matches(".q-tab.q-focusable")===!0),oe=W.length;if(oe===0)return;if(P===36)return j(W[0]),W[0].focus(),!0;if(P===35)return j(W[oe-1]),W[oe-1].focus(),!0;const se=P===(e.vertical===!0?38:37),Z=P===(e.vertical===!0?40:39),X=se===!0?-1:Z===!0?1:void 0;if(X!==void 0){const ue=i.value===!0?-1:1,Se=W.indexOf(V)+X*ue;return Se>=0&&Se<oe&&(j(W[Se]),W[Se].focus({preventScroll:!0})),!0}}const me=O(()=>_.value===!0?{get:P=>Math.abs(P.scrollLeft),set:(P,V)=>{P.scrollLeft=-V}}:e.vertical===!0?{get:P=>P.scrollTop,set:(P,V)=>{P.scrollTop=V}}:{get:P=>P.scrollLeft,set:(P,V)=>{P.scrollLeft=V}});function lt(P){const V=k.value,{get:W,set:oe}=me.value;let se=!1,Z=W(V);const X=P<Z?-1:1;return Z+=X*5,Z<0?(se=!0,Z=0):(X===-1&&Z<=P||X===1&&Z>=P)&&(se=!0,Z=P),oe(V,Z),b(),se}function ze(P,V){for(const W in P)if(P[W]!==V[W])return!1;return!0}function sn(){let P=null,V={matchedLen:0,queryDiff:9999,hrefLen:0};const W=$.filter(X=>X.routeData?.hasRouterLink.value===!0),{hash:oe,query:se}=n.$route,Z=Object.keys(se).length;for(const X of W){const ue=X.routeData.exact.value===!0;if(X.routeData[ue===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:Se,query:xt,matched:dn,href:fn}=X.routeData.resolvedLink.value,Rt=Object.keys(xt).length;if(ue===!0){if(Se!==oe||Rt!==Z||ze(se,xt)===!1)continue;P=X.name.value;break}if(Se!==""&&Se!==oe||Rt!==0&&ze(xt,se)===!1)continue;const Re={matchedLen:dn.length,queryDiff:Z-Rt,hrefLen:fn.length-Se.length};if(Re.matchedLen>V.matchedLen){P=X.name.value,V=Re;continue}else if(Re.matchedLen!==V.matchedLen)continue;if(Re.queryDiff<V.queryDiff)P=X.name.value,V=Re;else if(Re.queryDiff!==V.queryDiff)continue;Re.hrefLen>V.hrefLen&&(P=X.name.value,V=Re)}if(P===null&&$.some(X=>X.routeData===void 0&&X.name.value===I.value)===!0){it=!1;return}E({name:P,setCurrent:!0})}function rn(P){if(c(),C.value!==!0&&y.value!==null&&P.target&&typeof P.target.closest=="function"){const V=P.target.closest(".q-tab");V&&y.value.contains(V)===!0&&(C.value=!0,L.value===!0&&j(V))}}function ln(){d(()=>{C.value=!1},30)}function We(){na.avoidRouteWatcher===!1?w(sn):T()}function aa(){if(q===void 0){const P=J(()=>n.$route.fullPath,We);q=()=>{P(),q=void 0}}}function un(P){$.push(P),v.value++,h(),P.routeData===void 0||n.$route===void 0?w(()=>{if(L.value===!0){const V=I.value,W=V!=null&&V!==""?$.find(oe=>oe.name.value===V):null;W&&j(W.rootRef.value)}}):(aa(),P.routeData.hasRouterLink.value===!0&&We())}function cn(P){$.splice($.indexOf(P),1),v.value--,h(),q!==void 0&&P.routeData!==void 0&&($.every(V=>V.routeData===void 0)===!0&&q(),We())}const na={currentModel:I,tabProps:z,hasFocus:C,hasActiveTab:m,registerTab:un,unregisterTab:cn,verifyRouteModel:We,updateModel:E,onKbdNavigate:G,avoidRouteWatcher:!1};bn($a,na);function oa(){f!==null&&clearTimeout(f),D(),q?.()}let sa,it;return Ce(oa),Ma(()=>{sa=q!==void 0,oa()}),Fa(()=>{sa===!0&&(aa(),it=!0,We()),h()}),()=>M("div",{ref:y,class:R.value,role:"tablist",onFocusin:rn,onFocusout:ln},[M(Wn,{onResize:F}),M("div",{ref:k,class:S.value,onScroll:b},fe(t.default)),M(Te,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(A.value===!0?"":" q-tabs__arrow--faded"),name:e.leftIcon||s.iconSet.tabs[e.vertical===!0?"up":"left"],onMousedownPassive:ee,onTouchstartPassive:ee,onMouseupPassive:D,onMouseleavePassive:D,onTouchendPassive:D}),M(Te,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(N.value===!0?"":" q-tabs__arrow--faded"),name:e.rightIcon||s.iconSet.tabs[e.vertical===!0?"down":"right"],onMousedownPassive:ne,onTouchstartPassive:ne,onMouseupPassive:D,onMouseleavePassive:D,onTouchendPassive:D})])}}),Jt={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},ko=Object.keys(Jt);Jt.all=!0;function va(e){const t={};for(const a of ko)e[a]===!0&&(t[a]=!0);return Object.keys(t).length===0?Jt:(t.horizontal===!0?t.left=t.right=!0:t.left===!0&&t.right===!0&&(t.horizontal=!0),t.vertical===!0?t.up=t.down=!0:t.up===!0&&t.down===!0&&(t.vertical=!0),t.horizontal===!0&&t.vertical===!0&&(t.all=!0),t)}const Ao=["INPUT","TEXTAREA"];function ha(e,t){return t.event===void 0&&e.target!==void 0&&e.target.draggable!==!0&&typeof t.handler=="function"&&Ao.includes(e.target.nodeName.toUpperCase())===!1&&(e.qClonedBy===void 0||e.qClonedBy.indexOf(t.uid)===-1)}function xo(e){const t=[.06,6,50];return typeof e=="string"&&e.length&&e.split(":").forEach((a,n)=>{const s=parseFloat(a);s&&(t[n]=s)}),t}const Ro=wn({name:"touch-swipe",beforeMount(e,{value:t,arg:a,modifiers:n}){if(n.mouse!==!0&&pe.has.touch!==!0)return;const s=n.mouseCapture===!0?"Capture":"",o={handler:t,sensitivity:xo(a),direction:va(n),noop:_n,mouseStart(r){ha(r,o)&&Tn(r)&&(Ue(o,"temp",[[document,"mousemove","move",`notPassive${s}`],[document,"mouseup","end","notPassiveCapture"]]),o.start(r,!0))},touchStart(r){if(ha(r,o)){const l=r.target;Ue(o,"temp",[[l,"touchmove","move","notPassiveCapture"],[l,"touchcancel","end","notPassiveCapture"],[l,"touchend","end","notPassiveCapture"]]),o.start(r)}},start(r,l){pe.is.firefox===!0&&Pt(e,!0);const d=la(r);o.event={x:d.left,y:d.top,time:Date.now(),mouse:l===!0,dir:!1}},move(r){if(o.event===void 0)return;if(o.event.dir!==!1){Be(r);return}const l=Date.now()-o.event.time;if(l===0)return;const d=la(r),c=d.left-o.event.x,w=Math.abs(c),T=d.top-o.event.y,y=Math.abs(T);if(o.event.mouse!==!0){if(w<o.sensitivity[1]&&y<o.sensitivity[1]){o.end(r);return}}else if(window.getSelection().toString()!==""){o.end(r);return}else if(w<o.sensitivity[2]&&y<o.sensitivity[2])return;const k=w/l,I=y/l;o.direction.vertical===!0&&w<y&&w<100&&I>o.sensitivity[0]&&(o.event.dir=T<0?"up":"down"),o.direction.horizontal===!0&&w>y&&y<100&&k>o.sensitivity[0]&&(o.event.dir=c<0?"left":"right"),o.direction.up===!0&&w<y&&T<0&&w<100&&I>o.sensitivity[0]&&(o.event.dir="up"),o.direction.down===!0&&w<y&&T>0&&w<100&&I>o.sensitivity[0]&&(o.event.dir="down"),o.direction.left===!0&&w>y&&c<0&&y<100&&k>o.sensitivity[0]&&(o.event.dir="left"),o.direction.right===!0&&w>y&&c>0&&y<100&&k>o.sensitivity[0]&&(o.event.dir="right"),o.event.dir!==!1?(Be(r),o.event.mouse===!0&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Ht(),o.styleCleanup=L=>{o.styleCleanup=void 0,document.body.classList.remove("non-selectable");const A=()=>{document.body.classList.remove("no-pointer-events--children")};L===!0?setTimeout(A,50):A()}),o.handler({evt:r,touch:o.event.mouse!==!0,mouse:o.event.mouse,direction:o.event.dir,duration:l,distance:{x:w,y}})):o.end(r)},end(r){o.event!==void 0&&(at(o,"temp"),pe.is.firefox===!0&&Pt(e,!1),o.styleCleanup?.(!0),r!==void 0&&o.event.dir!==!1&&Be(r),o.event=void 0)}};if(e.__qtouchswipe=o,n.mouse===!0){const r=n.mouseCapture===!0||n.mousecapture===!0?"Capture":"";Ue(o,"main",[[e,"mousedown","mouseStart",`passive${r}`]])}pe.has.touch===!0&&Ue(o,"main",[[e,"touchstart","touchStart",`passive${n.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,t){const a=e.__qtouchswipe;a!==void 0&&(t.oldValue!==t.value&&(typeof t.value!="function"&&a.end(),a.handler=t.value),a.direction=va(t.modifiers))},beforeUnmount(e){const t=e.__qtouchswipe;t!==void 0&&(at(t,"main"),at(t,"temp"),pe.is.firefox===!0&&Pt(e,!1),t.styleCleanup?.(),delete e.__qtouchswipe)}});function Eo(){let e=Object.create(null);return{getCache:(t,a)=>e[t]===void 0?e[t]=typeof a=="function"?a():a:e[t],setCache(t,a){e[t]=a},hasCache(t){return Object.hasOwnProperty.call(e,t)},clearCache(t){t!==void 0?delete e[t]:e=Object.create(null)}}}const Po={name:{required:!0},disable:Boolean},ya={setup(e,{slots:t}){return()=>M("div",{class:"q-panel scroll",role:"tabpanel"},fe(t.default))}},Io={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},qo=["update:modelValue","beforeTransition","transition"];function Oo(){const{props:e,emit:t,proxy:a}=ge(),{getCache:n}=Eo(),{registerTimeout:s}=st();let o,r;const l=B(null),d={value:null};function c(u){const i=e.vertical===!0?"up":"left";q((a.$q.lang.rtl===!0?-1:1)*(u.direction===i?1:-1))}const w=O(()=>[[Ro,c,void 0,{horizontal:e.vertical!==!0,vertical:e.vertical,mouse:!0}]]),T=O(()=>e.transitionPrev||`slide-${e.vertical===!0?"down":"right"}`),y=O(()=>e.transitionNext||`slide-${e.vertical===!0?"up":"left"}`),k=O(()=>`--q-transition-duration: ${e.transitionDuration}ms`),I=O(()=>typeof e.modelValue=="string"||typeof e.modelValue=="number"?e.modelValue:String(e.modelValue)),L=O(()=>({include:e.keepAliveInclude,exclude:e.keepAliveExclude,max:e.keepAliveMax})),A=O(()=>e.keepAliveInclude!==void 0||e.keepAliveExclude!==void 0);J(()=>e.modelValue,(u,i)=>{const _=v(u)===!0?C(u):-1;r!==!0&&x(_===-1?0:_<C(i)?-1:1),d.value!==_&&(d.value=_,t("beforeTransition",u,i),s(()=>{t("transition",u,i)},e.transitionDuration))});function N(){q(1)}function Q(){q(-1)}function $(u){t("update:modelValue",u)}function v(u){return u!=null&&u!==""}function C(u){return o.findIndex(i=>i.props.name===u&&i.props.disable!==""&&i.props.disable!==!0)}function f(){return o.filter(u=>u.props.disable!==""&&u.props.disable!==!0)}function x(u){const i=u!==0&&e.animated===!0&&d.value!==-1?"q-transition--"+(u===-1?T.value:y.value):null;l.value!==i&&(l.value=i)}function q(u,i=d.value){let _=i+u;for(;_!==-1&&_<o.length;){const E=o[_];if(E!==void 0&&E.props.disable!==""&&E.props.disable!==!0){x(u),r=!0,t("update:modelValue",E.props.name),setTimeout(()=>{r=!1});return}_+=u}e.infinite===!0&&o.length!==0&&i!==-1&&i!==o.length&&q(u,u===-1?o.length:-1)}function z(){const u=C(e.modelValue);return d.value!==u&&(d.value=u),!0}function m(){const u=v(e.modelValue)===!0&&z()&&o[d.value];return e.keepAlive===!0?[M(Sn,L.value,[M(A.value===!0?n(I.value,()=>({...ya,name:I.value})):ya,{key:I.value,style:k.value},()=>u)])]:[M("div",{class:"q-panel scroll",style:k.value,key:I.value,role:"tabpanel"},[u])]}function g(){if(o.length!==0)return e.animated===!0?[M(ot,{name:l.value},m)]:m()}function R(u){return o=Cn(fe(u.default,[])).filter(i=>i.props!==null&&i.props.slot===void 0&&v(i.props.name)===!0),o.length}function S(){return o}return Object.assign(a,{next:N,previous:Q,goTo:$}),{panelIndex:d,panelDirectives:w,updatePanelsList:R,updatePanelIndex:z,getPanelContent:g,getEnabledPanels:f,getPanels:S,isValidPanelName:v,keepAliveProps:L,needsUniqueKeepAliveWrapper:A,goToPanelByOffset:q,goToPanel:$,nextPanel:N,previousPanel:Q}}const qt=ve({name:"QTabPanel",props:Po,setup(e,{slots:t}){return()=>M("div",{class:"q-tab-panel",role:"tabpanel"},fe(t.default))}}),$o=ve({name:"QTabPanels",props:{...Io,...Gt},emits:qo,setup(e,{slots:t}){const a=ge(),n=Yt(e,a.proxy.$q),{updatePanelsList:s,getPanelContent:o,panelDirectives:r}=Oo(),l=O(()=>"q-tab-panels q-panel-parent"+(n.value===!0?" q-tab-panels--dark q-dark":""));return()=>(s(t),kn("div",{class:l.value},o(),"pan",e.swipeable,()=>r.value))}}),Lo=ve({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:t}){const{proxy:{$q:a}}=ge(),n=bt(An,Ae);if(n===Ae)return console.error("QPage needs to be a deep child of QLayout"),Ae;if(bt(xn,Ae)===Ae)return console.error("QPage needs to be child of QPageContainer"),Ae;const o=O(()=>{const l=(n.header.space===!0?n.header.size:0)+(n.footer.space===!0?n.footer.size:0);if(typeof e.styleFn=="function"){const d=n.isContainer.value===!0?n.containerHeight.value:a.screen.height;return e.styleFn(l,d)}return{minHeight:n.isContainer.value===!0?n.containerHeight.value-l+"px":a.screen.height===0?l!==0?`calc(100vh - ${l}px)`:"100vh":a.screen.height-l+"px"}}),r=O(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>M("main",{class:r.value,style:o.value},fe(t.default))}}),Mo=()=>M("div",{key:"svg",class:"q-checkbox__bg absolute"},[M("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[M("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),M("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),Fo=ve({name:"QCheckbox",props:Yn,emits:Gn,setup(e){const t=Mo();function a(n,s){const o=O(()=>(n.value===!0?e.checkedIcon:s.value===!0?e.indeterminateIcon:e.uncheckedIcon)||null);return()=>o.value!==null?[M("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[M(Te,{class:"q-checkbox__icon",name:o.value})])]:[t]}return Xn("checkbox",a)}}),Vo=ve({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(e,{slots:t}){const a=O(()=>`q-card__section q-card__section--${e.horizontal===!0?"horiz row no-wrap":"vert"}`);return()=>M(e.tag,{class:a.value},fe(t.default))}}),Bo=ve({name:"QCardActions",props:{...Rn,vertical:Boolean},setup(e,{slots:t}){const a=En(e),n=O(()=>`q-card__actions ${a.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>M("div",{class:n.value},fe(t.default))}}),Do=ve({name:"QCard",props:{...Gt,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(e,{slots:t}){const{proxy:{$q:a}}=ge(),n=Yt(e,a),s=O(()=>"q-card"+(n.value===!0?" q-card--dark q-dark":"")+(e.bordered===!0?" q-card--bordered":"")+(e.square===!0?" q-card--square no-border-radius":"")+(e.flat===!0?" q-card--flat no-shadow":""));return()=>M(e.tag,{class:s.value},fe(t.default))}});function zo(e,t,a){let n;function s(){n!==void 0&&(ia.remove(n),n=void 0)}return Ce(()=>{e.value===!0&&s()}),{removeFromHistory:s,addToHistory(){n={condition:()=>a.value===!0,handler:t},ia.add(n)}}}let Xe=0,Ot,$t,et,Lt=!1,ba,wa,_a,$e=null;function No(e){Uo(e)&&Be(e)}function Uo(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=Pn(e),a=e.shiftKey&&!e.deltaX,n=!a&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),s=a||n?e.deltaY:e.deltaX;for(let o=0;o<t.length;o++){const r=t[o];if(eo(r,n))return n?s<0&&r.scrollTop===0?!0:s>0&&r.scrollTop+r.clientHeight===r.scrollHeight:s<0&&r.scrollLeft===0?!0:s>0&&r.scrollLeft+r.clientWidth===r.scrollWidth}return!0}function Ta(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function ct(e){Lt!==!0&&(Lt=!0,requestAnimationFrame(()=>{Lt=!1;const{height:t}=e.target,{clientHeight:a,scrollTop:n}=document.scrollingElement;(et===void 0||t!==window.innerHeight)&&(et=a-t,document.scrollingElement.scrollTop=n),n>et&&(document.scrollingElement.scrollTop-=Math.ceil((n-et)/8))}))}function Ca(e){const t=document.body,a=window.visualViewport!==void 0;if(e==="add"){const{overflowY:n,overflowX:s}=window.getComputedStyle(t);Ot=Zn(window),$t=Jn(window),ba=t.style.left,wa=t.style.top,_a=window.location.href,t.style.left=`-${Ot}px`,t.style.top=`-${$t}px`,s!=="hidden"&&(s==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),n!=="hidden"&&(n==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,pe.is.ios===!0&&(a===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",ct,Oe.passiveCapture),window.visualViewport.addEventListener("scroll",ct,Oe.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",Ta,Oe.passiveCapture))}pe.is.desktop===!0&&pe.is.mac===!0&&window[`${e}EventListener`]("wheel",No,Oe.notPassive),e==="remove"&&(pe.is.ios===!0&&(a===!0?(window.visualViewport.removeEventListener("resize",ct,Oe.passiveCapture),window.visualViewport.removeEventListener("scroll",ct,Oe.passiveCapture)):window.removeEventListener("scroll",Ta,Oe.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=ba,t.style.top=wa,window.location.href===_a&&window.scrollTo(Ot,$t),et=void 0)}function Ho(e){let t="add";if(e===!0){if(Xe++,$e!==null){clearTimeout($e),$e=null;return}if(Xe>1)return}else{if(Xe===0||(Xe--,Xe>0))return;if(t="remove",pe.is.ios===!0&&pe.is.nativeMobile===!0){$e!==null&&clearTimeout($e),$e=setTimeout(()=>{Ca(t),$e=null},100);return}}Ca(t)}function jo(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,Ho(t))}}}let dt=0;const Ko={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},Sa={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]},Qo=ve({name:"QDialog",inheritAttrs:!1,props:{...Da,...pt,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,backdropFilter:String,position:{type:String,default:"standard",validator:e=>["standard","top","bottom","left","right"].includes(e)}},emits:[...Ba,"shake","click","escapeKey"],setup(e,{slots:t,emit:a,attrs:n}){const s=ge(),o=B(null),r=B(!1),l=B(!1);let d=null,c=null,w,T;const y=O(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:k}=jo(),{registerTimeout:I}=st(),{registerTick:L,removeTick:A}=nt(),{transitionProps:N,transitionStyle:Q}=za(e,()=>Sa[e.position][0],()=>Sa[e.position][1]),$=O(()=>Q.value+(e.backdropFilter!==void 0?`;backdrop-filter:${e.backdropFilter};-webkit-backdrop-filter:${e.backdropFilter}`:"")),{showPortal:v,hidePortal:C,portalIsAccessible:f,renderPortal:x}=Ua(s,o,ne,"dialog"),{hide:q}=Na({showing:r,hideOnRouteChange:y,handleShow:i,handleHide:_,processOnMount:!0}),{addToHistory:z,removeFromHistory:m}=zo(r,q,y),g=O(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${Ko[e.position]}`+(l.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),R=O(()=>r.value===!0&&e.seamless!==!0),S=O(()=>e.autoClose===!0?{onClick:b}:{}),u=O(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${R.value===!0?"modal":"seamless"}`,n.class]);J(()=>e.maximized,D=>{r.value===!0&&j(D)}),J(R,D=>{k(D),D===!0?(to(ee),ao(F)):(ga(ee),ma(F))});function i(D){z(),c=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,j(e.maximized),v(),l.value=!0,e.noFocus!==!0?(document.activeElement?.blur(),L(E)):A(),I(()=>{if(s.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:G,bottom:me}=document.activeElement.getBoundingClientRect(),{innerHeight:lt}=window,ze=window.visualViewport!==void 0?window.visualViewport.height:lt;G>0&&me>ze/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-ze,me>=lt?1/0:Math.ceil(document.scrollingElement.scrollTop+me-ze/2))),document.activeElement.scrollIntoView()}T=!0,o.value.click(),T=!1}v(!0),l.value=!1,a("show",D)},e.transitionDuration)}function _(D){A(),m(),le(!0),l.value=!0,C(),c!==null&&(((D?.type.indexOf("key")===0?c.closest('[tabindex]:not([tabindex^="-"])'):void 0)||c).focus(),c=null),I(()=>{C(!0),l.value=!1,a("hide",D)},e.transitionDuration)}function E(D){Xt(()=>{let G=o.value;if(G!==null){if(D!==void 0){const me=G.querySelector(D);if(me!==null){me.focus({preventScroll:!0});return}}G.contains(document.activeElement)!==!0&&(G=G.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||G.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||G.querySelector("[autofocus], [data-autofocus]")||G,G.focus({preventScroll:!0}))}})}function h(D){D&&typeof D.focus=="function"?D.focus({preventScroll:!0}):E(),a("shake");const G=o.value;G!==null&&(G.classList.remove("q-animate--scale"),G.classList.add("q-animate--scale"),d!==null&&clearTimeout(d),d=setTimeout(()=>{d=null,o.value!==null&&(G.classList.remove("q-animate--scale"),E())},170))}function F(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&h():(a("escapeKey"),q()))}function le(D){d!==null&&(clearTimeout(d),d=null),(D===!0||r.value===!0)&&(j(!1),e.seamless!==!0&&(k(!1),ga(ee),ma(F))),D!==!0&&(c=null)}function j(D){D===!0?w!==!0&&(dt<1&&document.body.classList.add("q-body--dialog"),dt++,w=!0):w===!0&&(dt<2&&document.body.classList.remove("q-body--dialog"),dt--,w=!1)}function b(D){T!==!0&&(q(D),a("click",D))}function U(D){e.persistent!==!0&&e.noBackdropDismiss!==!0?q(D):e.noShake!==!0&&h()}function ee(D){e.allowFocusOutside!==!0&&f.value===!0&&In(o.value,D.target)!==!0&&E('[tabindex]:not([tabindex="-1"])')}Object.assign(s.proxy,{focus:E,shake:h,__updateRefocusTarget(D){c=D||null}}),Ce(le);function ne(){return M("div",{role:"dialog","aria-modal":R.value===!0?"true":"false",...n,class:u.value},[M(ot,{name:"q-transition--fade",appear:!0},()=>R.value===!0?M("div",{class:"q-dialog__backdrop fixed-full",style:$.value,"aria-hidden":"true",tabindex:-1,onClick:U}):null),M(ot,N.value,()=>r.value===!0?M("div",{ref:o,class:g.value,style:Q.value,tabindex:-1,...S.value},fe(t.default)):null)])}return x}}),ka=/^on[A-Z]/;function Wo(){const{attrs:e,vnode:t}=ge(),a={listeners:B({}),attributes:B({})};function n(){const s={},o={};for(const r in e)r!=="class"&&r!=="style"&&ka.test(r)===!1&&(s[r]=e[r]);for(const r in t.props)ka.test(r)===!0&&(o[r]=t.props[r]);a.attributes.value=s,a.listeners.value=o}return qn(n),n(),a}function Go({validate:e,resetValidation:t,requiresQForm:a}){const n=bt(On,!1);if(n!==!1){const{props:s,proxy:o}=ge();Object.assign(o,{validate:e,resetValidation:t}),J(()=>s.disable,r=>{r===!0?(typeof t=="function"&&t(),n.unbindComponent(o)):n.bindComponent(o)}),Qe(()=>{s.disable!==!0&&n.bindComponent(o)}),Ce(()=>{s.disable!==!0&&n.unbindComponent(o)})}else a===!0&&console.error("Parent QForm not found on useFormChild()!")}const Aa=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,xa=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,Ra=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,ft=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,gt=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,Mt={date:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e),time:e=>/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(e),fulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(e),timeOrFulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/.test(e),email:e=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e),hexColor:e=>Aa.test(e),hexaColor:e=>xa.test(e),hexOrHexaColor:e=>Ra.test(e),rgbColor:e=>ft.test(e),rgbaColor:e=>gt.test(e),rgbOrRgbaColor:e=>ft.test(e)||gt.test(e),hexOrRgbColor:e=>Aa.test(e)||ft.test(e),hexaOrRgbaColor:e=>xa.test(e)||gt.test(e),anyColor:e=>Ra.test(e)||ft.test(e)||gt.test(e)},Yo=[!0,!1,"ondemand"],Xo={modelValue:{},error:{type:Boolean,default:null},errorMessage:String,noErrorIcon:Boolean,rules:Array,reactiveRules:Boolean,lazyRules:{type:[Boolean,String],default:!1,validator:e=>Yo.includes(e)}};function Zo(e,t){const{props:a,proxy:n}=ge(),s=B(!1),o=B(null),r=B(!1);Go({validate:L,resetValidation:I});let l=0,d;const c=O(()=>a.rules!==void 0&&a.rules!==null&&a.rules.length!==0),w=O(()=>a.disable!==!0&&c.value===!0&&t.value===!1),T=O(()=>a.error===!0||s.value===!0),y=O(()=>typeof a.errorMessage=="string"&&a.errorMessage.length!==0?a.errorMessage:o.value);J(()=>a.modelValue,()=>{r.value=!0,w.value===!0&&a.lazyRules===!1&&A()});function k(){a.lazyRules!=="ondemand"&&w.value===!0&&r.value===!0&&A()}J(()=>a.reactiveRules,N=>{N===!0?d===void 0&&(d=J(()=>a.rules,k,{immediate:!0,deep:!0})):d!==void 0&&(d(),d=void 0)},{immediate:!0}),J(()=>a.lazyRules,k),J(e,N=>{N===!0?r.value=!0:w.value===!0&&a.lazyRules!=="ondemand"&&A()});function I(){l++,t.value=!1,r.value=!1,s.value=!1,o.value=null,A.cancel()}function L(N=a.modelValue){if(a.disable===!0||c.value===!1)return!0;const Q=++l,$=t.value!==!0?()=>{r.value=!0}:()=>{},v=(f,x)=>{f===!0&&$(),s.value=f,o.value=x||null,t.value=!1},C=[];for(let f=0;f<a.rules.length;f++){const x=a.rules[f];let q;if(typeof x=="function"?q=x(N,Mt):typeof x=="string"&&Mt[x]!==void 0&&(q=Mt[x](N)),q===!1||typeof q=="string")return v(!0,q),!1;q!==!0&&q!==void 0&&C.push(q)}return C.length===0?(v(!1),!0):(t.value=!0,Promise.all(C).then(f=>{if(f===void 0||Array.isArray(f)===!1||f.length===0)return Q===l&&v(!1),!0;const x=f.find(q=>q===!1||typeof q=="string");return Q===l&&v(x!==void 0,x),x===void 0},f=>(Q===l&&(console.error(f),v(!0)),!1)))}const A=$n(L,0);return Ce(()=>{d?.(),A.cancel()}),Object.assign(n,{resetValidation:I,validate:L}),Va(n,"hasError",()=>T.value),{isDirtyModel:r,hasRules:c,hasError:T,errorMessage:y,validate:L,resetValidation:I}}function Kt(e){return e!=null&&(""+e).length!==0}const Jo={...Gt,...Xo,label:String,stackLabel:Boolean,hint:String,hideHint:Boolean,prefix:String,suffix:String,labelColor:String,color:String,bgColor:String,filled:Boolean,outlined:Boolean,borderless:Boolean,standout:[Boolean,String],square:Boolean,loading:Boolean,labelSlot:Boolean,bottomSlots:Boolean,hideBottomSpace:Boolean,rounded:Boolean,dense:Boolean,itemAligned:Boolean,counter:Boolean,clearable:Boolean,clearIcon:String,disable:Boolean,readonly:Boolean,autofocus:Boolean,for:String},es={...Jo,maxlength:[Number,String]},ts=["update:modelValue","clear","focus","blur"];function as({requiredForAttr:e=!0,tagProp:t,changeEvent:a=!1}={}){const{props:n,proxy:s}=ge(),o=Yt(n,s.$q),r=no({required:e,getValue:()=>n.for});return{requiredForAttr:e,changeEvent:a,tag:t===!0?O(()=>n.tag):{value:"label"},isDark:o,editable:O(()=>n.disable!==!0&&n.readonly!==!0),innerLoading:B(!1),focused:B(!1),hasPopupOpen:!1,splitAttrs:Wo(),targetUid:r,rootRef:B(null),targetRef:B(null),controlRef:B(null)}}function ns(e){const{props:t,emit:a,slots:n,attrs:s,proxy:o}=ge(),{$q:r}=o;let l=null;e.hasValue===void 0&&(e.hasValue=O(()=>Kt(t.modelValue))),e.emitValue===void 0&&(e.emitValue=h=>{a("update:modelValue",h)}),e.controlEvents===void 0&&(e.controlEvents={onFocusin:z,onFocusout:m}),Object.assign(e,{clearValue:g,onControlFocusin:z,onControlFocusout:m,focus:x}),e.computedCounter===void 0&&(e.computedCounter=O(()=>{if(t.counter!==!1){const h=typeof t.modelValue=="string"||typeof t.modelValue=="number"?(""+t.modelValue).length:Array.isArray(t.modelValue)===!0?t.modelValue.length:0,F=t.maxlength!==void 0?t.maxlength:t.maxValues;return h+(F!==void 0?" / "+F:"")}}));const{isDirtyModel:d,hasRules:c,hasError:w,errorMessage:T,resetValidation:y}=Zo(e.focused,e.innerLoading),k=e.floatingLabel!==void 0?O(()=>t.stackLabel===!0||e.focused.value===!0||e.floatingLabel.value===!0):O(()=>t.stackLabel===!0||e.focused.value===!0||e.hasValue.value===!0),I=O(()=>t.bottomSlots===!0||t.hint!==void 0||c.value===!0||t.counter===!0||t.error!==null),L=O(()=>t.filled===!0?"filled":t.outlined===!0?"outlined":t.borderless===!0?"borderless":t.standout?"standout":"standard"),A=O(()=>`q-field row no-wrap items-start q-field--${L.value}`+(e.fieldClass!==void 0?` ${e.fieldClass.value}`:"")+(t.rounded===!0?" q-field--rounded":"")+(t.square===!0?" q-field--square":"")+(k.value===!0?" q-field--float":"")+(Q.value===!0?" q-field--labeled":"")+(t.dense===!0?" q-field--dense":"")+(t.itemAligned===!0?" q-field--item-aligned q-item-type":"")+(e.isDark.value===!0?" q-field--dark":"")+(e.getControl===void 0?" q-field--auto-height":"")+(e.focused.value===!0?" q-field--focused":"")+(w.value===!0?" q-field--error":"")+(w.value===!0||e.focused.value===!0?" q-field--highlighted":"")+(t.hideBottomSpace!==!0&&I.value===!0?" q-field--with-bottom":"")+(t.disable===!0?" q-field--disabled":t.readonly===!0?" q-field--readonly":"")),N=O(()=>"q-field__control relative-position row no-wrap"+(t.bgColor!==void 0?` bg-${t.bgColor}`:"")+(w.value===!0?" text-negative":typeof t.standout=="string"&&t.standout.length!==0&&e.focused.value===!0?` ${t.standout}`:t.color!==void 0?` text-${t.color}`:"")),Q=O(()=>t.labelSlot===!0||t.label!==void 0),$=O(()=>"q-field__label no-pointer-events absolute ellipsis"+(t.labelColor!==void 0&&w.value!==!0?` text-${t.labelColor}`:"")),v=O(()=>({id:e.targetUid.value,editable:e.editable.value,focused:e.focused.value,floatingLabel:k.value,modelValue:t.modelValue,emitValue:e.emitValue})),C=O(()=>{const h={};return e.targetUid.value&&(h.for=e.targetUid.value),t.disable===!0&&(h["aria-disabled"]="true"),h});function f(){const h=document.activeElement;let F=e.targetRef?.value;F&&(h===null||h.id!==e.targetUid.value)&&(F.hasAttribute("tabindex")===!0||(F=F.querySelector("[tabindex]")),F!==h&&F?.focus({preventScroll:!0}))}function x(){Xt(f)}function q(){oo(f);const h=document.activeElement;h!==null&&e.rootRef.value.contains(h)&&h.blur()}function z(h){l!==null&&(clearTimeout(l),l=null),e.editable.value===!0&&e.focused.value===!1&&(e.focused.value=!0,a("focus",h))}function m(h,F){l!==null&&clearTimeout(l),l=setTimeout(()=>{l=null,!(document.hasFocus()===!0&&(e.hasPopupOpen===!0||e.controlRef===void 0||e.controlRef.value===null||e.controlRef.value.contains(document.activeElement)!==!1))&&(e.focused.value===!0&&(e.focused.value=!1,a("blur",h)),F?.())})}function g(h){Be(h),r.platform.is.mobile!==!0?(e.targetRef?.value||e.rootRef.value).focus():e.rootRef.value.contains(document.activeElement)===!0&&document.activeElement.blur(),t.type==="file"&&(e.inputRef.value.value=null),a("update:modelValue",null),e.changeEvent===!0&&a("change",null),a("clear",t.modelValue),Fe(()=>{const F=d.value;y(),d.value=F})}function R(h){[13,32].includes(h.keyCode)&&g(h)}function S(){const h=[];return n.prepend!==void 0&&h.push(M("div",{class:"q-field__prepend q-field__marginal row no-wrap items-center",key:"prepend",onClick:Ge},n.prepend())),h.push(M("div",{class:"q-field__control-container col relative-position row no-wrap q-anchor--skip"},u())),w.value===!0&&t.noErrorIcon===!1&&h.push(_("error",[M(Te,{name:r.iconSet.field.error,color:"negative"})])),t.loading===!0||e.innerLoading.value===!0?h.push(_("inner-loading-append",n.loading!==void 0?n.loading():[M(Ln,{color:t.color})])):t.clearable===!0&&e.hasValue.value===!0&&e.editable.value===!0&&h.push(_("inner-clearable-append",[M(Te,{class:"q-field__focusable-action",name:t.clearIcon||r.iconSet.field.clear,tabindex:0,role:"button","aria-hidden":"false","aria-label":r.lang.label.clear,onKeyup:R,onClick:g})])),n.append!==void 0&&h.push(M("div",{class:"q-field__append q-field__marginal row no-wrap items-center",key:"append",onClick:Ge},n.append())),e.getInnerAppend!==void 0&&h.push(_("inner-append",e.getInnerAppend())),e.getControlChild!==void 0&&h.push(e.getControlChild()),h}function u(){const h=[];return t.prefix!==void 0&&t.prefix!==null&&h.push(M("div",{class:"q-field__prefix no-pointer-events row items-center"},t.prefix)),e.getShadowControl!==void 0&&e.hasShadow.value===!0&&h.push(e.getShadowControl()),Q.value===!0&&h.push(M("div",{class:$.value},fe(n.label,t.label))),e.getControl!==void 0?h.push(e.getControl()):n.rawControl!==void 0?h.push(n.rawControl()):n.control!==void 0&&h.push(M("div",{ref:e.targetRef,class:"q-field__native row",tabindex:-1,...e.splitAttrs.attributes.value,"data-autofocus":t.autofocus===!0||void 0},n.control(v.value))),t.suffix!==void 0&&t.suffix!==null&&h.push(M("div",{class:"q-field__suffix no-pointer-events row items-center"},t.suffix)),h.concat(fe(n.default))}function i(){let h,F;w.value===!0?T.value!==null?(h=[M("div",{role:"alert"},T.value)],F=`q--slot-error-${T.value}`):(h=fe(n.error),F="q--slot-error"):(t.hideHint!==!0||e.focused.value===!0)&&(t.hint!==void 0?(h=[M("div",t.hint)],F=`q--slot-hint-${t.hint}`):(h=fe(n.hint),F="q--slot-hint"));const le=t.counter===!0||n.counter!==void 0;if(t.hideBottomSpace===!0&&le===!1&&h===void 0)return;const j=M("div",{key:F,class:"q-field__messages col"},h);return M("div",{class:"q-field__bottom row items-start q-field__bottom--"+(t.hideBottomSpace!==!0?"animated":"stale"),onClick:Ge},[t.hideBottomSpace===!0?j:M(ot,{name:"q-transition--field-message"},()=>j),le===!0?M("div",{class:"q-field__counter"},n.counter!==void 0?n.counter():e.computedCounter.value):null])}function _(h,F){return F===null?null:M("div",{key:h,class:"q-field__append q-field__marginal row no-wrap items-center q-anchor--skip"},F)}let E=!1;return Ma(()=>{E=!0}),Fa(()=>{E===!0&&t.autofocus===!0&&o.focus()}),t.autofocus===!0&&Qe(()=>{o.focus()}),Ce(()=>{l!==null&&clearTimeout(l)}),Object.assign(o,{focus:x,blur:q}),function(){const F=e.getControl===void 0&&n.control===void 0?{...e.splitAttrs.attributes.value,"data-autofocus":t.autofocus===!0||void 0,...C.value}:C.value;return M(e.tag.value,{ref:e.rootRef,class:[A.value,s.class],style:s.style,...F},[n.before!==void 0?M("div",{class:"q-field__before q-field__marginal row no-wrap items-center",onClick:Ge},n.before()):null,M("div",{class:"q-field__inner relative-position col self-stretch"},[M("div",{ref:e.controlRef,class:N.value,tabindex:-1,...e.controlEvents},S()),I.value===!0?i():null]),n.after!==void 0?M("div",{class:"q-field__after q-field__marginal row no-wrap items-center",onClick:Ge},n.after()):null])}}const Ea={date:"####/##/##",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"},{tokenMap:Pa,tokenKeys:os}=ja({"#":{pattern:"[\\d]",negate:"[^\\d]"},S:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]"},N:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]"},A:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleUpperCase()},a:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleLowerCase()},X:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleUpperCase()},x:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleLowerCase()}});function ja(e){const t=Object.keys(e),a={};return t.forEach(n=>{const s=e[n];a[n]={...s,regex:new RegExp(s.pattern)}}),{tokenMap:a,tokenKeys:t}}function Ka(e){return new RegExp("\\\\([^.*+?^${}()|([\\]])|([.*+?^${}()|[\\]])|(["+e.join("")+"])|(.)","g")}const Ia=/[.*+?^${}()|[\]\\]/g,ss=Ka(os),re="",rs={mask:String,reverseFillMask:Boolean,fillMask:[Boolean,String],unmaskedValue:Boolean,maskTokens:Object};function ls(e,t,a,n){let s,o,r,l,d,c;const w=O(()=>{if(e.maskTokens===void 0||e.maskTokens===null)return{tokenMap:Pa,tokenRegexMask:ss};const{tokenMap:m}=ja(e.maskTokens),g={...Pa,...m};return{tokenMap:g,tokenRegexMask:Ka(Object.keys(g))}}),T=B(null),y=B(I());function k(){return e.autogrow===!0||["textarea","text","search","url","tel","password"].includes(e.type)}J(()=>e.type+e.autogrow,A),J(()=>e.mask,m=>{if(m!==void 0)N(y.value,!0);else{const g=q(y.value);A(),e.modelValue!==g&&t("update:modelValue",g)}}),J(()=>e.fillMask+e.reverseFillMask,()=>{T.value===!0&&N(y.value,!0)}),J(()=>e.unmaskedValue,()=>{T.value===!0&&N(y.value)});function I(){if(A(),T.value===!0){const m=f(q(e.modelValue));return e.fillMask!==!1?z(m):m}return e.modelValue}function L(m){if(m<s.length)return s.slice(-m);let g="",R=s;const S=R.indexOf(re);if(S!==-1){for(let u=m-R.length;u>0;u--)g+=re;R=R.slice(0,S)+g+R.slice(S)}return R}function A(){if(T.value=e.mask!==void 0&&e.mask.length!==0&&k(),T.value===!1){l=void 0,s="",o="";return}const m=Ea[e.mask]===void 0?e.mask:Ea[e.mask],g=typeof e.fillMask=="string"&&e.fillMask.length!==0?e.fillMask.slice(0,1):"_",R=g.replace(Ia,"\\$&"),S=[],u=[],i=[];let _=e.reverseFillMask===!0,E="",h="";m.replace(w.value.tokenRegexMask,(b,U,ee,ne,D)=>{if(ne!==void 0){const G=w.value.tokenMap[ne];i.push(G),h=G.negate,_===!0&&(u.push("(?:"+h+"+)?("+G.pattern+"+)?(?:"+h+"+)?("+G.pattern+"+)?"),_=!1),u.push("(?:"+h+"+)?("+G.pattern+")?")}else if(ee!==void 0)E="\\"+(ee==="\\"?"":ee),i.push(ee),S.push("([^"+E+"]+)?"+E+"?");else{const G=U!==void 0?U:D;E=G==="\\"?"\\\\\\\\":G.replace(Ia,"\\\\$&"),i.push(G),S.push("([^"+E+"]+)?"+E+"?")}});const F=new RegExp("^"+S.join("")+"("+(E===""?".":"[^"+E+"]")+"+)?"+(E===""?"":"["+E+"]*")+"$"),le=u.length-1,j=u.map((b,U)=>U===0&&e.reverseFillMask===!0?new RegExp("^"+R+"*"+b):U===le?new RegExp("^"+b+"("+(h===""?".":h)+"+)?"+(e.reverseFillMask===!0?"$":R+"*")):new RegExp("^"+b));r=i,l=b=>{const U=F.exec(e.reverseFillMask===!0?b:b.slice(0,i.length+1));U!==null&&(b=U.slice(1).join(""));const ee=[],ne=j.length;for(let D=0,G=b;D<ne;D++){const me=j[D].exec(G);if(me===null)break;G=G.slice(me.shift().length),ee.push(...me)}return ee.length!==0?ee.join(""):b},s=i.map(b=>typeof b=="string"?b:re).join(""),o=s.split(re).join(g)}function N(m,g,R){const S=n.value,u=S.selectionEnd,i=S.value.length-u,_=q(m);g===!0&&A();const E=f(_,g),h=e.fillMask!==!1?z(E):E,F=y.value!==h;S.value!==h&&(S.value=h),F===!0&&(y.value=h),document.activeElement===S&&Fe(()=>{if(h===o){const j=e.reverseFillMask===!0?o.length:0;S.setSelectionRange(j,j,"forward");return}if(R==="insertFromPaste"&&e.reverseFillMask!==!0){const j=S.selectionEnd;let b=u-1;for(let U=d;U<=b&&U<j;U++)s[U]!==re&&b++;$.right(S,b);return}if(["deleteContentBackward","deleteContentForward"].indexOf(R)!==-1){const j=e.reverseFillMask===!0?u===0?h.length>E.length?1:0:Math.max(0,h.length-(h===o?0:Math.min(E.length,i)+1))+1:u;S.setSelectionRange(j,j,"forward");return}if(e.reverseFillMask===!0)if(F===!0){const j=Math.max(0,h.length-(h===o?0:Math.min(E.length,i+1)));j===1&&u===1?S.setSelectionRange(j,j,"forward"):$.rightReverse(S,j)}else{const j=h.length-i;S.setSelectionRange(j,j,"backward")}else if(F===!0){const j=Math.max(0,s.indexOf(re),Math.min(E.length,u)-1);$.right(S,j)}else{const j=u-1;$.right(S,j)}});const le=e.unmaskedValue===!0?q(h):h;String(e.modelValue)!==le&&(e.modelValue!==null||le!=="")&&a(le,!0)}function Q(m,g,R){const S=f(q(m.value));g=Math.max(0,s.indexOf(re),Math.min(S.length,g)),d=g,m.setSelectionRange(g,R,"forward")}const $={left(m,g){const R=s.slice(g-1).indexOf(re)===-1;let S=Math.max(0,g-1);for(;S>=0;S--)if(s[S]===re){g=S,R===!0&&g++;break}if(S<0&&s[g]!==void 0&&s[g]!==re)return $.right(m,0);g>=0&&m.setSelectionRange(g,g,"backward")},right(m,g){const R=m.value.length;let S=Math.min(R,g+1);for(;S<=R;S++)if(s[S]===re){g=S;break}else s[S-1]===re&&(g=S);if(S>R&&s[g-1]!==void 0&&s[g-1]!==re)return $.left(m,R);m.setSelectionRange(g,g,"forward")},leftReverse(m,g){const R=L(m.value.length);let S=Math.max(0,g-1);for(;S>=0;S--)if(R[S-1]===re){g=S;break}else if(R[S]===re&&(g=S,S===0))break;if(S<0&&R[g]!==void 0&&R[g]!==re)return $.rightReverse(m,0);g>=0&&m.setSelectionRange(g,g,"backward")},rightReverse(m,g){const R=m.value.length,S=L(R),u=S.slice(0,g+1).indexOf(re)===-1;let i=Math.min(R,g+1);for(;i<=R;i++)if(S[i-1]===re){g=i,g>0&&u===!0&&g--;break}if(i>R&&S[g-1]!==void 0&&S[g-1]!==re)return $.leftReverse(m,R);m.setSelectionRange(g,g,"forward")}};function v(m){t("click",m),c=void 0}function C(m){if(t("keydown",m),La(m)===!0||m.altKey===!0)return;const g=n.value,R=g.selectionStart,S=g.selectionEnd;if(m.shiftKey||(c=void 0),m.keyCode===37||m.keyCode===39){m.shiftKey&&c===void 0&&(c=g.selectionDirection==="forward"?R:S);const u=$[(m.keyCode===39?"right":"left")+(e.reverseFillMask===!0?"Reverse":"")];if(m.preventDefault(),u(g,c===R?S:R),m.shiftKey){const i=g.selectionStart;g.setSelectionRange(Math.min(c,i),Math.max(c,i),"forward")}}else m.keyCode===8&&e.reverseFillMask!==!0&&R===S?($.left(g,R),g.setSelectionRange(g.selectionStart,S,"backward")):m.keyCode===46&&e.reverseFillMask===!0&&R===S&&($.rightReverse(g,S),g.setSelectionRange(R,g.selectionEnd,"forward"))}function f(m,g){if(m==null||m==="")return"";if(e.reverseFillMask===!0)return x(m,g);const R=r;let S=0,u="";for(let i=0;i<R.length;i++){const _=m[S],E=R[i];if(typeof E=="string")u+=E,g===!0&&_===E&&S++;else if(_!==void 0&&E.regex.test(_))u+=E.transform!==void 0?E.transform(_):_,S++;else return u}return u}function x(m,g){const R=r,S=s.indexOf(re);let u=m.length-1,i="";for(let _=R.length-1;_>=0&&u!==-1;_--){const E=R[_];let h=m[u];if(typeof E=="string")i=E+i,g===!0&&h===E&&u--;else if(h!==void 0&&E.regex.test(h))do i=(E.transform!==void 0?E.transform(h):h)+i,u--,h=m[u];while(S===_&&h!==void 0&&E.regex.test(h));else return i}return i}function q(m){return typeof m!="string"||l===void 0?typeof m=="number"?l(""+m):m:l(m)}function z(m){return o.length-m.length<=0?m:e.reverseFillMask===!0&&m.length!==0?o.slice(0,-m.length)+m:m+o.slice(m.length)}return{innerValue:y,hasMask:T,moveCursorForPaste:Q,updateMaskValue:N,onMaskedKeydown:C,onMaskedClick:v}}function is(e,t){function a(){const n=e.modelValue;try{const s="DataTransfer"in window?new DataTransfer:"ClipboardEvent"in window?new ClipboardEvent("").clipboardData:void 0;return Object(n)===n&&("length"in n?Array.from(n):[n]).forEach(o=>{s.items.add(o)}),{files:s.files}}catch{return{files:void 0}}}return O(()=>{if(e.type==="file")return a()})}const us=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/,cs=/[\u4e00-\u9fff\u3400-\u4dbf\u{20000}-\u{2a6df}\u{2a700}-\u{2b73f}\u{2b740}-\u{2b81f}\u{2b820}-\u{2ceaf}\uf900-\ufaff\u3300-\u33ff\ufe30-\ufe4f\uf900-\ufaff\u{2f800}-\u{2fa1f}]/u,ds=/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/,fs=/[a-z0-9_ -]$/i;function gs(e){return function(a){if(a.type==="compositionend"||a.type==="change"){if(a.target.qComposing!==!0)return;a.target.qComposing=!1,e(a)}else a.type==="compositionupdate"&&a.target.qComposing!==!0&&typeof a.data=="string"&&(pe.is.firefox===!0?fs.test(a.data)===!1:us.test(a.data)===!0||cs.test(a.data)===!0||ds.test(a.data)===!0)===!0&&(a.target.qComposing=!0)}}const Ft=ve({name:"QInput",inheritAttrs:!1,props:{...es,...rs,...so,modelValue:[String,Number,FileList],shadowText:String,type:{type:String,default:"text"},debounce:[String,Number],autogrow:Boolean,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...ts,"paste","change","keydown","click","animationend"],setup(e,{emit:t,attrs:a}){const{proxy:n}=ge(),{$q:s}=n,o={};let r=NaN,l,d,c=null,w;const T=B(null),y=ro(e),{innerValue:k,hasMask:I,moveCursorForPaste:L,updateMaskValue:A,onMaskedKeydown:N,onMaskedClick:Q}=ls(e,t,_,T),$=is(e),v=O(()=>Kt(k.value)),C=gs(u),f=as({changeEvent:!0}),x=O(()=>e.type==="textarea"||e.autogrow===!0),q=O(()=>x.value===!0||["text","search","url","tel","password"].includes(e.type)),z=O(()=>{const b={...f.splitAttrs.listeners.value,onInput:u,onPaste:S,onChange:h,onBlur:F,onFocus:ua};return b.onCompositionstart=b.onCompositionupdate=b.onCompositionend=C,I.value===!0&&(b.onKeydown=N,b.onClick=Q),e.autogrow===!0&&(b.onAnimationend=i),b}),m=O(()=>{const b={tabindex:0,"data-autofocus":e.autofocus===!0||void 0,rows:e.type==="textarea"?6:void 0,"aria-label":e.label,name:y.value,...f.splitAttrs.attributes.value,id:f.targetUid.value,maxlength:e.maxlength,disabled:e.disable===!0,readonly:e.readonly===!0};return x.value===!1&&(b.type=e.type),e.autogrow===!0&&(b.rows=1),b});J(()=>e.type,()=>{T.value&&(T.value.value=e.modelValue)}),J(()=>e.modelValue,b=>{if(I.value===!0){if(d===!0&&(d=!1,String(b)===r))return;A(b)}else k.value!==b&&(k.value=b,e.type==="number"&&o.hasOwnProperty("value")===!0&&(l===!0?l=!1:delete o.value));e.autogrow===!0&&Fe(E)}),J(()=>e.autogrow,b=>{b===!0?Fe(E):T.value!==null&&a.rows>0&&(T.value.style.height="auto")}),J(()=>e.dense,()=>{e.autogrow===!0&&Fe(E)});function g(){Xt(()=>{const b=document.activeElement;T.value!==null&&T.value!==b&&(b===null||b.id!==f.targetUid.value)&&T.value.focus({preventScroll:!0})})}function R(){T.value?.select()}function S(b){if(I.value===!0&&e.reverseFillMask!==!0){const U=b.target;L(U,U.selectionStart,U.selectionEnd)}t("paste",b)}function u(b){if(!b||!b.target)return;if(e.type==="file"){t("update:modelValue",b.target.files);return}const U=b.target.value;if(b.target.qComposing===!0){o.value=U;return}if(I.value===!0)A(U,!1,b.inputType);else if(_(U),q.value===!0&&b.target===document.activeElement){const{selectionStart:ee,selectionEnd:ne}=b.target;ee!==void 0&&ne!==void 0&&Fe(()=>{b.target===document.activeElement&&U.indexOf(b.target.value)===0&&b.target.setSelectionRange(ee,ne)})}e.autogrow===!0&&E()}function i(b){t("animationend",b),E()}function _(b,U){w=()=>{c=null,e.type!=="number"&&o.hasOwnProperty("value")===!0&&delete o.value,e.modelValue!==b&&r!==b&&(r=b,U===!0&&(d=!0),t("update:modelValue",b),Fe(()=>{r===b&&(r=NaN)})),w=void 0},e.type==="number"&&(l=!0,o.value=b),e.debounce!==void 0?(c!==null&&clearTimeout(c),o.value=b,c=setTimeout(w,e.debounce)):w()}function E(){requestAnimationFrame(()=>{const b=T.value;if(b!==null){const U=b.parentNode.style,{scrollTop:ee}=b,{overflowY:ne,maxHeight:D}=s.platform.is.firefox===!0?{}:window.getComputedStyle(b),G=ne!==void 0&&ne!=="scroll";G===!0&&(b.style.overflowY="hidden"),U.marginBottom=b.scrollHeight-1+"px",b.style.height="1px",b.style.height=b.scrollHeight+"px",G===!0&&(b.style.overflowY=parseInt(D,10)<b.scrollHeight?"auto":"hidden"),U.marginBottom="",b.scrollTop=ee}})}function h(b){C(b),c!==null&&(clearTimeout(c),c=null),w?.(),t("change",b.target.value)}function F(b){b!==void 0&&ua(b),c!==null&&(clearTimeout(c),c=null),w?.(),l=!1,d=!1,delete o.value,e.type!=="file"&&setTimeout(()=>{T.value!==null&&(T.value.value=k.value!==void 0?k.value:"")})}function le(){return o.hasOwnProperty("value")===!0?o.value:k.value!==void 0?k.value:""}Ce(()=>{F()}),Qe(()=>{e.autogrow===!0&&E()}),Object.assign(f,{innerValue:k,fieldClass:O(()=>`q-${x.value===!0?"textarea":"input"}`+(e.autogrow===!0?" q-textarea--autogrow":"")),hasShadow:O(()=>e.type!=="file"&&typeof e.shadowText=="string"&&e.shadowText.length!==0),inputRef:T,emitValue:_,hasValue:v,floatingLabel:O(()=>v.value===!0&&(e.type!=="number"||isNaN(k.value)===!1)||Kt(e.displayValue)),getControl:()=>M(x.value===!0?"textarea":"input",{ref:T,class:["q-field__native q-placeholder",e.inputClass],style:e.inputStyle,...m.value,...z.value,...e.type!=="file"?{value:le()}:$.value}),getShadowControl:()=>M("div",{class:"q-field__native q-field__shadow absolute-bottom no-pointer-events"+(x.value===!0?"":" text-no-wrap")},[M("span",{class:"invisible"},le()),M("span",e.shadowText)])});const j=ns(f);return Object.assign(n,{focus:g,select:R,getNativeElement:()=>T.value}),Va(n,"nativeEl",()=>T.value),j}});function Ze(e){return`Cannot initialize Office APIs: ${e} 
Are you viewing this within the Excel side panel?`}async function Qa(e=!1){const t=e?De().tracker.startOperation("Initialize Office APIs"):null;try{if(typeof Office>"u"){const n=Ze("`Office` is not defined in any loaded module.");throw t?.addInfo(n),new Error(n)}if(Office==null){const n=Ze("`Office` is defined as `null` or `undefined`.");throw t?.addInfo(n,{Office}),new Error(n)}if(!("onReady"in Office)||typeof Office.onReady!="function"){const n=Ze("`Office` does not have an `onReady` property, or it is not a function.");throw t?.addInfo(n,{Office}),new Error(n)}let a;try{a=await Office.onReady()}catch(n){const s=Ze(`Error while getting Office ready: '${xe(n)}'.`);throw t?.addInfo(s,{Error:n}),new Error(s)}if(a.host===null&&a.platform===null){const n=Ze("API is loaded and ready, but no suitable environment was detected.");throw t?.addInfo(n),new Error(n)}return t?.setSuccess("Office APIs are ready.",{onReadyInfo:a}),a}catch(a){if(t)return t.setFailureAndRethrow(a);throw a}}const Wa="CC923F2C-0638-4F36-9E18-A4910CD71B74",He=`${Wa}.config`,vt=`${Wa}.v1ApiToken`,ht=ms();function Ke(){const e=new lo;return Office.context.document.settings.saveAsync(t=>{t.status===Office.AsyncResultStatus.Succeeded?e.tryResolve():e.tryReject(t.error)}),e.promise()}async function ms(){const e=ae().startOperation("Init Document Settings");try{await Qa();const t=(()=>{const o=Office.context.document.settings.get(He);return o?(e.addInfo("DocumentConfig loaded.",o),o):(e.addInfo("DocumentConfig not found. Will use defaults."),{appVersion:"",lastCompletedSyncUtc:"",lastCompletedSyncVersion:0})})(),a=(()=>{const o=Office.context.document.settings.get(vt);return Zt(o)?(e.addInfo(`ExpLens loaded the LunchMoney API Token from the document (${o.length} chars).`),o.toString()):(e.addInfo("ExpLens could NOT load the LunchMoney API Token from the document."),null)})();let n=he(t.lastCompletedSyncUtc)?null:new Date(t.lastCompletedSyncUtc);n!==null&&isNaN(n.getTime())&&(e.addInfo(`ERROR! lastCompletedSyncUtc (='${t.lastCompletedSyncUtc}') cannot be parsed into a valid date.`),n=null);const s={appVersion:B(t.appVersion),lastCompletedSyncUtc:B(n),lastCompletedSyncVersion:B(t.lastCompletedSyncVersion),apiToken:B(a)};return J(s.appVersion,async o=>{const r=await ht,l={appVersion:o,lastCompletedSyncUtc:r.lastCompletedSyncUtc.value?r.lastCompletedSyncUtc.value.toISOString():"",lastCompletedSyncVersion:r.lastCompletedSyncVersion.value};Office.context.document.settings.set(He,l),await Ke()}),J(s.lastCompletedSyncUtc,async o=>{const r=await ht,l={appVersion:r.appVersion.value,lastCompletedSyncUtc:o===null?"":o.toISOString(),lastCompletedSyncVersion:r.lastCompletedSyncVersion.value};Office.context.document.settings.set(He,l),await Ke()}),J(s.lastCompletedSyncVersion,async o=>{const r=await ht,l={appVersion:r.appVersion.value,lastCompletedSyncUtc:r.lastCompletedSyncUtc.value?r.lastCompletedSyncUtc.value.toISOString():"",lastCompletedSyncVersion:o};Office.context.document.settings.set(He,l),await Ke()}),e.setSuccess(),s}catch(t){return e.setFailureAndRethrow(t)}}async function ea(){const e=await ht;return{appVersion:Mn(e.appVersion),lastCompletedSyncUtc:e.lastCompletedSyncUtc,lastCompletedSyncVersion:e.lastCompletedSyncVersion,apiToken:e.apiToken,storeApiToken:async()=>{const t=ae().startOperation("Storing API token in the document.");try{Office.context.document.settings.set(vt,e.apiToken.value),await Ke(),t.setSuccess()}catch(a){t.setFailureAndRethrow(a)}},clearAllStorage:async()=>{const t=ae().startOperation("Clearing all settings from the document store.");try{Office.context.document.settings.remove(He),Office.context.document.settings.remove(vt),await Ke(),t.setSuccess()}catch(a){t.setFailureAndRethrow(a)}},clearTokenStorage:async()=>{const t=ae().startOperation("Clearing API Token all settings from the document store.");try{Office.context.document.settings.remove(He),Office.context.document.settings.remove(vt),await Ke(),t.setSuccess()}catch(a){t.setFailureAndRethrow(a)}}}}async function ps(e,t){const a=t.workbook.tables.getItemOrNullObject(e);if(a.load("name, id, worksheet, isNullObject"),await t.sync(),a.isNullObject)return null;const n=a.worksheet,s=a.getRange();return n.load("name, id"),s.load("address"),await t.sync(),{table:a,sheet:n,range:s}}async function wt(e,t,a){t.load(["id"]),await a.sync();const n=t.id,s=await ps(e,a);if(s===null)return null;if(s.sheet.id!==n)throw new Error(`Table '${e}' exists on the wrong sheet ('${s.range.address}').
 NOTE: Don't name any objects using prefix 'EL.'; Don't edit any auto-created sheets, except where specified.
 SOLUTION: Back-up your data, delete or rename the unexpected table, reload the Add-In.`);return s}async function Vt(e,t){let a=t.workbook.worksheets.getItemOrNullObject(e);return a.load("name, id, isNullObject"),await t.sync(),a.isNullObject&&(a=t.workbook.worksheets.add(e),await t.sync()),a.activate(),a.load("name, id, isNullObject"),await t.sync(),a}function Ga(e,t=!1){const a=e.getTime();if(isNaN(a))throw new Error(`Invalid date '${String(e)}'.`);const n=t?a-e.getTimezoneOffset()*60*1e3:a,s=Math.abs(Date.UTC(1899,11,30)),o=1440*60*1e3,r=(n+s)/o,l=10**8;return Math.round(r*l)/l}function Ie(e){if(e===void 0)return;if(e===null)return null;const t=new Date(e);try{return Ga(t)}catch(a){throw typeof a=="object"&&a instanceof Error&&a.message.startsWith("Invalid date")?new Error(`Invalid date string '${e}'.`,{cause:a}):a}}function Y(e,t,a,n,s,o){return e.getRangeByIndexes(t.row+a,t.col+n,s,o)}function vs(e){const t=e.indexOf("!");return t<0?e.trim():e.substring(t+1).trim()}function Ya(e){return e.replace(/([A-Z]+)(\d+)/g,"$$$1$$$2")}async function hs(e,t,a){let n,s=!1;try{n=await e.text(),s=!0}catch(l){n=`Error getting response text (${xe(l)})`}let o={_:"Response text not available for parsing."};if(s)try{o=JSON.parse(n)}catch(l){o={errorParsingResponseText:xe(l)}}const r=t?`(${t}) `:"";a.setFailure(`Request ${r}failed with status ${e.status} (${e.statusText}).`,{responseText:n,responseObject:o})}async function At(e,t,a,n){const s=De().tracker.startOperation("Calling remote API",a);try{if(s.addInfo({method:e,api:t}),n!==void 0?s.addInfo({apiToken:`specified (${n.length} chars)`}):n=(await ea()).apiToken.value??void 0,!Zt(n))throw new Error(`Cannot '${a}', because no API Token is set.`);const o=new Headers;o.append("Authorization",`Bearer ${n}`);const r=`https://dev.lunchmoney.app/v1/${t}`,l=await fetch(r,{method:e,headers:o,redirect:"follow"});if(!l.ok)throw await hs(l,a,s),new Error(`Bad response (${l.status}) during '${a}'.`);const d=await l.text();return s.setSuccess(),d}catch(o){return s.setFailureAndRethrow(o,{method:e,api:t,purposeDescription:a})}}function ta(e,t,a){const n=(o,r)=>{if(o<0||100<o)throw new Error(`'${r}' must be in range 0..100%, but it is '${o}%'.`)};if(n(e,"sheetProgressPercentageRangeStart"),n(t,"sheetProgressPercentageRangeEnd"),t<=e)throw new Error(`Expected sheetProgressPercentageRangeStart < sheetProgressPercentageRangeEnd, but found: sheetProgressPercentageRangeStart='${e}', sheetProgressPercentageRangeEnd='${t}'.`);const s=t-e;return{setPercentage:o=>{n(o,"relativeProgressPercentage");const r=e+s/100*o;a.progressPercentage.value=r}}}const ys="EL.Tags",Le="EL.TagsTable",Bt="EL.TagGroupsTable",Xa=":",bs=":Ungrouped";function Za(e){return[...e.keys()].sort()}function Ja(e,t){const a=e.get(t);return a===void 0?[]:[...a].sort()}function ws(e,t){let a=e.get(t.group);return a===void 0&&(a=new Set,e.set(t.group,a)),a.add(t.value),e}function en(e){const t=e.indexOf(Xa);return t<0?{group:bs,value:e,isGrp:!1,name:e.trim()}:{group:e.substring(0,t),value:e.substring(t+1),isGrp:!0,name:e.trim()}}async function _s(e){const t=ta(3,15,e);t.setPercentage(0),e.sheets.tags.activate(),await e.excel.sync();const a=e.sheets.tags.getRange("B4:F4");a.clear();const n=a.getCell(0,0);await e.excel.sync();const s=De().tracker.startOperation("Download Tags");try{t.setPercentage(5);const o={row:7,col:1},r="Structured:Group",l="Structured:Value",d=["id","name","description","archived",r,l];{e.sheets.tags.getRange("B2").values=[["Tags"]],e.sheets.tags.getRange("B2:E2").style="Heading 1";const v=e.sheets.tags.getRange("B3:E3");v.clear(),v.merge(),v.format.horizontalAlignment=Excel.HorizontalAlignment.left,v.format.verticalAlignment=Excel.VerticalAlignment.center,v.format.fill.color="#fff8dc",v.format.font.color="d76dcc",v.format.font.size=10,v.getCell(0,0).values=[["This tab is managed by ExpLens. Do not modify."]],await e.excel.sync()}t.setPercentage(10);const c=await At("GET","tags","get all tags"),w=JSON.parse(c);t.setPercentage(50),Y(e.sheets.tags,o,-3,0,1,1).values=[["Tags"]],Y(e.sheets.tags,o,-3,0,1,d.length).style="Heading 2",await e.excel.sync();const T=await wt(Le,e.sheets.tags,e.excel),y=T!==null?T.table:await(async()=>{const v=e.sheets.tags.tables.add(Y(e.sheets.tags,o,0,0,2,1),!0);return v.name=Le,v.style="TableStyleMedium10",await e.excel.sync(),s.addInfo(`New Tags table '${Le}' created.`),v})();for(y.columns.load("count"),y.rows.load("count"),await e.excel.sync();y.columns.count<d.length;)y.columns.add(),y.columns.load("count"),await e.excel.sync();for(;y.columns.count>d.length;)y.columns.getItemAt(0).delete(),y.columns.load("count"),await e.excel.sync();y.getHeaderRowRange().values=[d],y.columns.load("count"),await e.excel.sync(),y.rows.count>1&&y.rows.deleteRowsAt(0,y.rows.count-1),y.getDataBodyRange().values=[Array(d.length).fill("")],y.rows.load("count"),await e.excel.sync();{const v=y.getRange();v.load("address"),await e.excel.sync(),s.addInfo(`Tags table "${Le}" is located at "${v.address}", it has ${y.columns.count} columns and ${y.rows.count} row(s).`)}const k=Y(e.sheets.tags,o,-1,0,1,1);k.format.fill.clear(),k.format.font.color="#7e350e",k.format.font.bold=!0,k.format.horizontalAlignment="Right",k.values=[["Count:"]];const I=Y(e.sheets.tags,o,-1,1,1,1);I.format.fill.color="#f2f2f2",I.format.font.color="#7e350e",I.format.font.bold=!0,I.format.horizontalAlignment="Left",I.formulas=[[`="  " & COUNTA(${Le}[name])`]],await e.excel.sync(),t.setPercentage(60),e.tags.assignable.clear(),e.tags.groupListFormulaLocations.clear(),e.tags.byId.clear();const L=w.sort((v,C)=>io(v.name,C.name));for(let v=0;v<L.length;v++){const C=L[v],f=en(C.name);ws(e.tags.assignable,f),e.tags.byId.set(C.id,f);const x=[C.id,C.name,C.description,C.archived,f.group,f.value];v===0?y.rows.getItemAt(0).getRange().values=[x]:y.rows.add(-1,[x]),y.rows.load("count"),await e.excel.sync()}y.getRange().format.autofitColumns(),await e.excel.sync(),Y(e.sheets.tags,o,-3,0,1,1).values=[["LunchMoney Tags"]],await e.excel.sync(),s.addInfo(`Tags table has ${y.rows.count} rows after the refresh.`),t.setPercentage(75);const A={row:o.row,col:o.col+d.length+1};Y(e.sheets.tags,A,-3,0,1,1).values=[["Tag Groups"]],Y(e.sheets.tags,A,-3,0,1,e.tags.assignable.size).style="Heading 2",await e.excel.sync();const N=await wt(Bt,e.sheets.tags,e.excel);N!==null&&(N.table.delete(),await e.excel.sync()),t.setPercentage(85);const Q=Za(e.tags.assignable);for(let v=0;v<Q.length;v++){const C=Q[v],f=Y(e.sheets.tags,A,0,v,1,1),x=Y(e.sheets.tags,A,1,v,1,1),q=Y(e.sheets.tags,A,2,v,1,1),z=Y(e.sheets.tags,A,3,v,1,1),m=Ja(e.tags.assignable,C).length,g=Y(e.sheets.tags,A,3,v,m,1);f.load(["address"]),x.load(["address"]),z.load(["address"]),await e.excel.sync();const R=vs(f.address),S=Ya(z.address);e.tags.groupListFormulaLocations.set(C,S),f.formulas=[[""]],f.values=[[C]],q.values=[[""]],q.formulas=[[""]],q.format.fill.clear(),g.values=Array(m).fill([""]),g.formulas=Array(m).fill([""]),g.format.fill.color="#f2f2f2",g.format.font.color="#7e350e",g.format.font.bold=!1,g.format.horizontalAlignment="Left";const u=g.format.borders.getItem("EdgeLeft");u.color="white",u.style="Continuous",u.weight="Medium",z.values=[[""]],z.formulas=[[`= FILTER(${Le}[${l}], ${Le}[${r}]=${R})`]],x.values=[[""]],x.formulas=[[`= COUNTA(${S}#)`]],f.format.autofitColumns(),z.format.autofitColumns(),await e.excel.sync()}t.setPercentage(95);const $=e.sheets.tags.tables.add(Y(e.sheets.tags,A,0,0,2,Q.length),!0);$.name=Bt,$.style="TableStyleMedium10",await e.excel.sync(),s.addInfo(`New Tags Groups table '${Bt}' created.`),t.setPercentage(100),s.setSuccess()}catch(o){n.values=[[`ERR: ${xe(o)}`]],n.format.font.color="#FF0000",await e.excel.sync(),s.setFailureAndRethrow(o)}}var qe,Ve;class rt{constructor(){Et(this,qe,[]);Et(this,Ve,new Map);Ne(this,"tryAdd",(t,a)=>ye(this,Ve).has(t)?!1:(ye(this,qe).push(a),ye(this,Ve).set(t,a),!0));Ne(this,"has",t=>ye(this,Ve).has(t));Ne(this,"getByIndex",t=>ye(this,qe)[t]);Ne(this,"getByKey",t=>ye(this,Ve).get(t));Ne(this,"map",t=>ye(this,qe).map(t))}get length(){return ye(this,qe).length}[Symbol.iterator](){return ye(this,qe)[Symbol.iterator]()}}qe=new WeakMap,Ve=new WeakMap;const Ts="EL.Categories",Me="EL.CategoriesTable",ke=["LabelId","description","is_group","is_income","exclude_from_budget","exclude_from_totals","archived","created_at","updated_at","archived_on","LabelL1","LabelL2","LunchId","order","name"];function Cs(e){const t=[];for(const a of ke)t.push(e[a]);return t}function qa(e,t){e=e.trim();let a=0;for(let n=0;n<e.length;n++)if(e[n]==="/"&&(a++,a===t))return e.substring(0,n);return e}async function Ss(e){const t=ta(16,30,e);t.setPercentage(0),e.sheets.cats.activate(),await e.excel.sync();const a=e.sheets.cats.getRange("B4:F4");a.clear();const n=a.getCell(0,0);await e.excel.sync();const s=ae().startOperation("Download Categories");try{t.setPercentage(2);const o=await At("GET","categories?format=flattened","get all categories");t.setPercentage(35);const r=JSON.parse(o);t.setPercentage(40);const l=new Map;for(const f of r.categories)l.set(f.id,f);const d=[];for(const f of l.values()){const x=m=>m===null?void 0:l.get(m);let q=f.name.trim(),z=x(f.group_id);for(;z;)q=`${z.name.trim()}/${q}`,z=x(z.group_id);d.push({LabelId:q,is_group:f.is_group,is_income:f.is_income,exclude_from_budget:f.exclude_from_budget,exclude_from_totals:f.exclude_from_totals,description:f.description??"",updated_at:Ie(f.updated_at),archived:f.archived,created_at:Ie(f.created_at),archived_on:f.archived_on===null?"":Ie(f.archived_on),LabelL1:qa(q,1),LabelL2:qa(q,2),LunchId:f.id,order:f.order,name:f.name})}d.sort((f,x)=>f.order-x.order),e.cats.assignable=new rt;for(const f of d)f.is_group!==!0&&f.archived!==!0&&e.cats.assignable.tryAdd(f.LunchId,f.LabelId);t.setPercentage(55),await wt(Me,e.sheets.cats,e.excel);const c={row:7,col:3},w={row:7,col:1};{e.excel.workbook.application.suspendApiCalculationUntilNextSync(),e.excel.workbook.application.suspendScreenUpdatingUntilNextSync();const f=e.sheets.cats.getUsedRange();f.clear(),f.conditionalFormats.clearAll(),Y(e.sheets.cats,c,0,0,1,ke.length).values=[ke];const x=d.map(z=>Cs(z));Y(e.sheets.cats,c,1,0,d.length,ke.length).values=x;const q=e.sheets.cats.tables.add(Y(e.sheets.cats,c,0,0,d.length+1,ke.length),!0);q.name=Me,q.style="TableStyleMedium12";for(let z=0;z<ke.length;z++){const m=ke[z];(m.endsWith("_on")||m.endsWith("_at"))&&(Y(e.sheets.cats,c,1,z,d.length,1).numberFormat=[["yyyy-mm-dd hh:mm"]])}}await e.excel.sync(),Y(e.sheets.cats,c,0,0,1,ke.length).format.autofitColumns(),await e.excel.sync(),t.setPercentage(80);const T=Y(e.sheets.cats,w,0,0,1,1);T.values=[["LabelId"]],T.format.fill.color="#0f9ed5",T.format.font.color="#FFFFFF";const y=Y(e.sheets.cats,w,1,0,1,1);y.load("address"),await e.excel.sync(),e.cats.listFormulaLocation=Ya(y.address),y.formulas=[[`= LET(
    LabelIdValues, ${Me}[LabelId],
    OrderValues, ${Me}[order],
    Filter, (${Me}[is_group] = FALSE) * (${Me}[archived] = FALSE),

    FilteredValues, FILTER(
        HSTACK(LabelIdValues, OrderValues),
        Filter
    ),
    SortedValues, SORTBY(FilteredValues, INDEX(FilteredValues,,2), 1),
    SortedAndFilteredLabelIds, INDEX(SortedValues,,1),
    SortedAndFilteredLabelIds
)`]];const k=e.cats.assignable.length,I=Y(e.sheets.cats,w,0,0,k+1,1);I.format.font.bold=!0;const L=I.format.borders.getItem("EdgeTop");L.color="#0f9ed5",L.weight="Thick",L.style="Continuous";const A=I.format.borders.getItem("EdgeLeft");A.color="#0f9ed5",A.weight="Thick",A.style="Continuous";const N=I.format.borders.getItem("EdgeRight");N.color="#0f9ed5",N.weight="Thick",N.style="Continuous";const Q=I.format.borders.getItem("EdgeBottom");Q.color="#0f9ed5",Q.weight="Thick",Q.style="Continuous",await e.excel.sync(),y.format.autofitColumns(),await e.excel.sync(),t.setPercentage(90);const $=Y(e.sheets.cats,c,-1,-1,1,1);$.values=[[" counts "]],$.format.horizontalAlignment="Center",$.format.font.color="#074f69",$.format.font.bold=!0;const v=Y(e.sheets.cats,c,-1,0,1,1);v.format.horizontalAlignment="Left",v.format.fill.color="#f2f2f2",v.format.font.color="#074f69",v.format.font.bold=!0,v.formulas=[[`="  " & COUNTA(${Me}[labelId])`]];const C=Y(e.sheets.cats,w,-1,0,1,1);C.format.horizontalAlignment="Left",C.format.fill.color="#f2f2f2",C.format.font.color="#074f69",C.format.font.bold=!0,C.formulas=[[`="  " & COUNTA(${e.cats.listFormulaLocation}#)`]],await e.excel.sync(),t.setPercentage(95);{e.sheets.cats.getRange("B2").values=[["Categories"]],e.sheets.cats.getRange("B2:E2").style="Heading 1";const f=e.sheets.cats.getRange("B3:E3");f.clear(),f.merge(),f.format.horizontalAlignment=Excel.HorizontalAlignment.left,f.format.verticalAlignment=Excel.VerticalAlignment.center,f.format.fill.color="#fff8dc",f.format.font.color="d76dcc",f.format.font.size=10,f.getCell(0,0).values=[["This tab is managed by ExpLens. Do not modify."]]}e.sheets.cats.getRange("B5").values=[["Assignable Categories"]],e.sheets.cats.getRange("B5:B5").style="Heading 2",e.sheets.cats.getRange("D5").values=[["All Categories"]],Y(e.sheets.cats,{row:4,col:3},0,0,1,ke.length).style="Heading 2",await e.excel.sync(),t.setPercentage(100),s.setSuccess()}catch(o){n.values=[[`ERR: ${xe(o)}`]],n.format.font.color="#FF0000",await e.excel.sync(),s.setFailureAndRethrow(o)}}const _t="<Tag Groups Columns>",Qt=`Tag${Xa}`,_e={LunchId:"LunchId",LastSyncVersion:"LastSyncVersion"},Je='_($* #,##0.00_);_($* -#,##0.00_);_($* "-"??_);_(@_)',yt=[p("date",e=>Ie(e.trn.date),"yyyy-mm-dd"),p("Account",e=>e.trn.account_display_name),p("Payer",e=>(e.pld?.account_owner??"").replace(/[.,?!:_]/g," ").replace(/\s+/g," ").trim().replace(/\b(\w)(\w*)/g,(s,o,r)=>o+r.toLowerCase()),null,async(e,t,a)=>{e.font.load(["size"]),await a.excel.sync(),e.font.size=Math.max(e.font.size-2,9),e.horizontalAlignment="Left",await on()?.(e,t,a)}),p("payee",e=>e.trn.payee),p("Amount",e=>e.trn.to_base,Je),p("Category",e=>Dt(e.trn.category_group_name,e.trn.category_name),null,async(e,t,a)=>{t.clear(),await a.excel.sync(),t.ignoreBlanks=!0,Zt(a.cats.listFormulaLocation)?t.rule={list:{inCellDropDown:!0,source:`=${a.cats.listFormulaLocation}#`}}:t.prompt={showPrompt:!0,title:"",message:"Failed to determine valid options for Category"}}),p(_t,e=>null),p("Plaid:MerchantCategory",e=>tt(e.pld?.category)),p("Plaid:TransactionCategory",e=>{const t=e.pld?.personal_finance_category?.primary?.replaceAll("_"," ").trim()??"",a=e.pld?.personal_finance_category?.detailed?.replaceAll("_"," ").trim()??"",n=a.startsWith(t)?a.slice(t.length).trim():a,s=/\b(\w)(\w*)/g,o=(d,c,w)=>c+w.toLowerCase(),r=t.replace(s,o),l=n.replace(s,o);return Dt(r,l)}),p("status",e=>e.trn.status),p("recurring_description",e=>e.trn.recurring_description),p("ContainerMoniker",e=>`=LET(
    ContainerId, IFS(
        [@[group_id]] <> "", [@[group_id]],
        [@[parent_id]] <> "", [@[parent_id]],
        TRUE, ""
    ),
    ContainerPayee, XLOOKUP(ContainerId, [LunchId], [payee], ""),
    ContainerMoniker, IF(ContainerPayee <> "",
        ContainerPayee,
        IFS(
            AND(--[@[is_group]], --[@[has_children]]), "[_IS_GROUP_HAS_CHILDREN_]",
            [@[is_group]], "[_IS_GROUP_]",
            [@[has_children]], "[_HAS_CHILDREN_]",
            TRUE, ""
        )
    ),
    ContainerMoniker
)`),p("is_income",e=>e.trn.is_income),p("exclude_from_budget",e=>e.trn.exclude_from_budget),p("exclude_from_totals",e=>e.trn.exclude_from_totals),p("has_children",e=>e.trn.has_children),p("is_group",e=>e.trn.is_group),p("is_pending",e=>e.trn.is_pending),p("display_notes",e=>e.trn.display_notes),p("currency",e=>e.trn.currency),p("to_base",e=>e.trn.to_base,Je),p("category_id",e=>e.trn.category_id),p("category_name",e=>e.trn.category_name),p("category_group_id",e=>e.trn.category_group_id),p("category_group_name",e=>e.trn.category_group_name),p("created_at",e=>e.trn.created_at),p("updated_at",e=>e.trn.updated_at),p("notes",e=>e.trn.notes),p("original_name",e=>e.trn.original_name),p("recurring_id",e=>e.trn.recurring_id),p("recurring_payee",e=>e.trn.recurring_payee),p("recurring_cadence",e=>e.trn.recurring_cadence),p("recurring_granularity",e=>e.trn.recurring_granularity),p("recurring_quantity",e=>e.trn.recurring_quantity),p("recurring_type",e=>e.trn.recurring_type),p("recurring_amount",e=>e.trn.recurring_amount,Je),p("recurring_currency",e=>e.trn.recurring_currency),p("parent_id",e=>e.trn.parent_id),p("group_id",e=>e.trn.group_id),p("_amount",e=>e.trn.amount,Je),p("AccountWithOwner",e=>Dt(e.trn.account_display_name,e.pld?.account_owner)),p("asset_id",e=>e.trn.asset_id),p("asset_institution_name",e=>e.trn.asset_institution_name),p("asset_name",e=>e.trn.asset_name),p("asset_display_name",e=>e.trn.asset_display_name),p("asset_status",e=>e.trn.asset_status),p("plaid_account_id",e=>e.trn.plaid_account_id),p("plaid_account_name",e=>e.trn.plaid_account_name),p("plaid_account_mask",e=>e.trn.plaid_account_mask),p("institution_name",e=>e.trn.institution_name),p("plaid_account_display_name",e=>e.trn.plaid_account_display_name),p("plaid_category",e=>e.trn.plaid_category??""),p("source",e=>e.trn.source),p("display_name",e=>e.trn.display_name),p("account_display_name",e=>e.trn.account_display_name),p("original_tags",e=>tt(e.trn.tags?.map(t=>t.name),nn)),p("external_id",e=>e.trn.external_id),p("plaid:account_id",e=>e.pld?.account_id),p("plaid:account_owner",e=>e.pld?.account_owner),p("plaid:amount",e=>e.pld?.amount,Je),p("plaid:authorized_date",e=>Ie(e.pld?.authorized_date),"yyyy-mm-dd"),p("plaid:authorized_datetime",e=>Ie(e.pld?.authorized_datetime),"yyyy-mm-dd hh:mm:ss"),p("plaid:category,l1",e=>e.pld?.category?.[0]),p("plaid:category,l2",e=>tt([e.pld?.category?.[0],e.pld?.category?.[1]])),p("plaid:category,l3",e=>tt([e.pld?.category?.[0],e.pld?.category?.[1],e.pld?.category?.[2]])),p("plaid:category_id",e=>e.pld?.category_id),p("plaid:check_number",e=>e.pld?.check_number),p("plaid:counterparties.count",e=>e.pld?.counterparties?.length),p("plaid:counterparty#01.confidence_level",e=>e.pld?.counterparties?.[0]?.confidence_level),p("plaid:counterparty#01.entity_id",e=>e.pld?.counterparties?.[0]?.entity_id),p("plaid:counterparty#01.logo_url",e=>e.pld?.counterparties?.[0]?.logo_url),p("plaid:counterparty#01.name",e=>e.pld?.counterparties?.[0]?.name),p("plaid:counterparty#01.phone_number",e=>e.pld?.counterparties?.[0]?.phone_number),p("plaid:counterparty#01.type",e=>e.pld?.counterparties?.[0]?.type),p("plaid:counterparty#01.website",e=>e.pld?.counterparties?.[0]?.website),p("plaid:date",e=>Ie(e.pld?.date),"yyyy-mm-dd"),p("plaid:datetime",e=>Ie(e.pld?.datetime),"yyyy-mm-dd hh:mm:ss"),p("plaid:iso_currency_code",e=>e.pld?.iso_currency_code),p("plaid:location.address",e=>e.pld?.location?.address),p("plaid:location.city",e=>e.pld?.location?.city),p("plaid:location.country",e=>e.pld?.location?.country),p("plaid:location.lat",e=>e.pld?.location?.lat),p("plaid:location.lon",e=>e.pld?.location?.lon),p("plaid:location.postal_code",e=>e.pld?.location?.postal_code),p("plaid:location.region",e=>e.pld?.location?.region),p("plaid:location.store_number",e=>e.pld?.location?.store_number),p("plaid:logo_url",e=>e.pld?.logo_url),p("plaid:merchant_entity_id",e=>e.pld?.merchant_entity_id),p("plaid:merchant_name",e=>e.pld?.merchant_name),p("plaid:name",e=>e.pld?.name),p("plaid:payment_channel",e=>e.pld?.payment_channel),p("plaid:payment_meta.by_order_of",e=>e.pld?.payment_meta?.by_order_of),p("plaid:payment_meta.payee",e=>e.pld?.payment_meta?.payee),p("plaid:payment_meta.payer",e=>e.pld?.payment_meta?.payer),p("plaid:payment_meta.payment_method",e=>e.pld?.payment_meta?.payment_method),p("plaid:payment_meta.payment_processor",e=>e.pld?.payment_meta?.payment_processor),p("plaid:payment_meta.ppd_id",e=>e.pld?.payment_meta?.ppd_id),p("plaid:payment_meta.reason",e=>e.pld?.payment_meta?.reason),p("plaid:payment_meta.reference_number",e=>e.pld?.payment_meta?.reference_number),p("plaid:pending",e=>e.pld?.pending),p("plaid:pending_transaction_id",e=>e.pld?.pending_transaction_id),p("plaid:personal_finance_category.confidence_level",e=>e.pld?.personal_finance_category?.confidence_level),p("plaid:personal_finance_category.detailed",e=>e.pld?.personal_finance_category?.detailed),p("plaid:personal_finance_category.primary",e=>e.pld?.personal_finance_category?.primary),p("plaid:personal_finance_category.version",e=>e.pld?.personal_finance_category?.version),p("plaid:personal_finance_category_icon_url",e=>e.pld?.personal_finance_category_icon_url),p("plaid:transaction_code",e=>e.pld?.transaction_code),p("plaid:transaction_id",e=>e.pld?.transaction_id),p("plaid:transaction_type",e=>e.pld?.transaction_type),p("plaid:unofficial_currency_code",e=>e.pld?.unofficial_currency_code),p("plaid:website",e=>e.pld?.website),p(_e.LunchId,e=>e.trn.id,null,e=>{e.font.size=6,e.verticalAlignment="Center",e.horizontalAlignment="Right"}),p("plaid:website",e=>e.pld?.website),p(_e.LastSyncVersion,e=>null)];function p(e,t,a=null,n=null){return{name:e.trim(),valueFn:t,numberFormat:a,formatFn:n??on()}}function ks(e,t){const a=t?.tags.groupListFormulaLocations.get(e),n=async(s,o,r)=>{o.clear(),await r.excel.sync(),o.ignoreBlanks=!0,a?o.rule={list:{inCellDropDown:!0,source:`=${a}#`}}:o.prompt={showPrompt:!0,title:"",message:`Failed to determine valid options for '${Tt(e)}'`}};return{name:Tt(e),valueFn:s=>tn(s,e),numberFormat:null,formatFn:n}}function As(e){const t=Za(e.tags.assignable).map(s=>ks(s,e)),a=yt.flatMap(s=>s.name===_t?t:s),n=new rt;for(const s of a)n.tryAdd(s.name,s);return n}function xs(){let e=yt.findIndex(t=>t.name===_t);return e>=0||(De().tracker.observeEvent(uo.Wrn,`The 'transactionColumnsSpecs' should contain '${_t}', but it does not. A graceful fallback will be used, but this should be addressed!`),e=yt.findIndex(t=>t.name.toUpperCase()==="CATEGORY"),e<0&&(e=yt.findIndex(t=>t.name.toUpperCase()==="PAYEE")),e<0&&(e=0)),e}function tn(e,t){const a=Ja(e.tag,t);return tt(a,nn)}function Tt(e){return`${Qt}${e}`.trim()}function Ct(e){if(e=e.trim(),!!e.startsWith(Qt))return e.substring(Qt.length)}function Oa(e,t,a){const n=a.getByKey(t);let s;if(n!==void 0)s=n.valueFn(e);else{const o=Ct(t);if(o!==void 0)s=tn(e,o);else throw new Error(`Cannot find specification for column '${t}'.`)}return s??""}const an=" / ",nn=", ";function Dt(e,t,a=an){const n=e??"",s=t??"";return n.length>0&&s.length>0?n+a+s:n+s}function tt(e,t=an){return e==null?null:e.map(a=>he(a)?"*":a).join(t)}function on(){return null}const Rs="EL.Transactions",Wt="EL.TransactionsTable";async function Es(e,t,a){const n=ae().startOperation("Create new Transactions table");try{const s={row:7,col:1},o=e.map(d=>d.name),r=Y(t,s,0,0,2,o.length);r.clear(),r.conditionalFormats.clearAll(),await a.sync(),Y(t,s,0,0,1,o.length).values=[o];const l=t.tables.add(r,!0);return l.name=Wt,l.style="TableStyleMedium9",await a.sync(),l.load(["name","id"]),l.getRange().load(["address"]),await a.sync(),n.setSuccess(`New Transactions table '${l.name}' created.`),l}catch(s){return n.setFailureAndRethrow(s)}}async function Ps(e,t){e.columns.load(["count","items"]),e.rows.load(["count"]),await t.excel.sync();const a=t.tags.assignable.keys().map(r=>Tt(r)),n=new Set(a);let s;for(let r=0;r<e.columns.count;r++){const l=e.columns.getItemAt(r).load(["name"]);if(await t.excel.sync(),n.delete(l.name),n.size===0)return;Ct(l.name)&&(s=s===void 0?r:s)}s===void 0&&(s=xs());const o=[...n].sort().reverse();for(const r of o)e.columns.add(s,void 0,r);await t.excel.sync()}function St(e,t){switch(e.clear(),e.format.horizontalAlignment=Excel.HorizontalAlignment.center,e.format.verticalAlignment=Excel.VerticalAlignment.center,e.format.font.size=10,t){case"Read-Only":e.format.fill.color="#f2ceef",e.format.font.color="#d76dcc";break;case"Editable":e.format.fill.color="#b5e6a2",e.format.font.color="#4ea72e";break}e.dataValidation.prompt={showPrompt:!0,title:`${t} column`,message:t==="Read-Only"?"Let ExpLens manage it for you.":t==="Editable"?"Select a value from the dropdown":""}}async function Is(e){e.sheets.trans.getRange("B2").values=[["Transactions"]],e.sheets.trans.getRange("B2:E2").style="Heading 1";const t=e.sheets.trans.getRange("B3:E3");t.clear(),t.merge(),t.format.horizontalAlignment=Excel.HorizontalAlignment.left,t.format.verticalAlignment=Excel.VerticalAlignment.center,t.format.fill.color="#fff8dc",t.format.font.color="d76dcc",t.format.font.size=10,t.getCell(0,0).values=[["This tab is managed by ExpLens. Only modify specific columns:"]];const a=e.sheets.trans.getRange("B4:B4");St(a,"Editable"),a.format.font.bold=!0,a.values=[["Editable Columns"]];const n=e.sheets.trans.getRange("C4:C4");St(n,"Read-Only"),n.format.font.bold=!0,n.values=[["Read-Only Columns"]],await e.excel.sync()}async function qs(e,t,a){const n=ae().startOperation("Create Read-Only vs Editable hint header row for Transactions");try{const s=e.getRange();s.load(["address","rowIndex","columnIndex"]),await a.excel.sync();const o=new Set(["Category"]);for(const d of a.tags.assignable.keys())o.add(Tt(d));const r={row:s.rowIndex-1,col:s.columnIndex},l=Y(a.sheets.trans,r,0,0,1,t.length);St(l,"Read-Only"),await a.excel.sync();for(let d=0;d<e.columns.count;d++){const c=t[d];if(c&&o.has(c)){const w=Y(a.sheets.trans,r,0,d,1,1);St(w,"Editable")}}await a.excel.sync(),n.setSuccess()}catch(s){n.setFailureAndRethrow(s)}}function Os(e,t){const a=ae().startOperation("Validate Transactions table Column names");try{let n=0,s=0;for(;;){for(;n<e.length&&Ct(e.getByIndex(n).name);)n++;for(;s<t.length&&Ct(t[s]);)s++;if(n===e.length&&s===t.length)return a.setSuccess(),!0;if(n===e.length||s===t.length)return a.setFailure(`isColumnNamingEquivalent(..):
The lengths of 'columnsSpecs' (${e.length}) and actualColumnNames (${t.length}) are different after accounting for dynamic tag columns.`),!1;if(e.getByIndex(n)?.name!==t[s])return a.setFailure(`isColumnNamingEquivalent(..):
After accounting for dynamic tag columns, aligned headers are not the same:
columnsSpecs.getByIndex(${n})?.name !== actualColumnNames[${s}] ('${e.getByIndex(n)?.name}' !=== '${t[s]}').`),!1;n++,s++}}catch(n){return a.setFailureAndRethrow(n)}}async function $s(e,t,a){const n=ae().startOperation(`Read ${e.rows.count} existing data rows from '${e.name}'`);let s=null;try{const o=new rt,r=t.findIndex(c=>c===_e.LunchId),d=e.columns.getItemAt(r).getDataBodyRange();d.load(["values"]),await a.excel.sync();for(let c=0;c<e.rows.count;c++){c%250===0&&(s?.setSuccess(),s=ae().startOperation(`Read rows ${c}...${c+250}, out of ${e.rows.count} from '${e.name}'`));const T=e.rows.getItemAt(c).getRange(),y=d.values[c];if(y===void 0)throw new Error(`readExistingTransactions: idColRange.values[${c}] should be a one element array containing the id, but it is undefined.`);const k=y[0];if(k===void 0)throw new Error(`readExistingTransactions: lunchId (=idColRange.values[${c}][0]) should be a number (the ID), but it is undefined.`);const I=Number(k);if(!Number.isInteger(I))throw new Error(`Invalid ${_e.LunchId}-value ('${k}') for item on row ${c}.`);o.tryAdd(I,T)}return s?.setSuccess(),n.setSuccess(`Done reading ${o.length} existing data rows from table '${e.name}'.`),o}catch(o){return s?.setFailure(o),n.setFailureAndRethrow(o)}}async function Ls(e,t){if(e>t){const n=e;e=t,t=n}const a=ae().startOperation(`Retrieve transactions from Lunch Money (${ut(e)}...${ut(t)})`);try{const n=[];let s=e;for(;s<=t;){const l=new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth()+1,0)),d=l<t?l:t,c=ut(s),w=ut(d),T=await At("GET",`transactions?start_date=${c}&end_date=${w}`,`get all transactions ${c}...${w}`),y=ae().startOperation(`Parse fetched transactions ${c}...${w}`);try{const k=JSON.parse(T);if(k.has_more)throw new Error(`The LunchMoney 'v1/transactions' API returned 'true' in the 'has_more' field.
 This was previously not supported by the backend, but it has apparently changed. This is a breaking change in the backend API. The ExpLense needs to be updated and tested to account for this.
 Please reach out to the developers on GitHub.`);if(k.transactions===void 0){const L=k.error;throw L?new Error(`LunchMoney returned a non-error-code response, but the payload contains an error message instead of data:
 "${L}"`):new Error("LunchMoney returned a non-error-code response, but the payload contains does not contain expected data.")}const I=k.transactions.length;for(let L=0;L<I;L++){const A=k.transactions[L];if(A===void 0)throw new Error(`fetched.transactions[${L}] is undefined, but fetched.transactions.length=${I}`);n.push(A)}y.setSuccess({countFetched:k.transactions.length})}catch(k){y.setFailureAndRethrow(k)}s=new Date(Date.UTC(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()+1))}const o=ae().startOperation(`Parse Tags, Plaid & other metadata, and hydrate ${n.length} transactions`),r=new rt;try{let l=0;for(let d=0;d<n.length;d++){const c=n[d];if(!c)continue;const w=c.id;if(!Number.isInteger(w))throw new Error(`Cannot parse ID of fetched transaction #${d}. Integer ID expected. (Actual id='${w}'.)`);const T={trn:c,pld:null,tag:new Map,id:w};r.tryAdd(T.id,T);const y=c.plaid_metadata;if(y!=null&&typeof y=="string"){const L=JSON.parse(y);T.pld=L,l++}const I=T.trn.tags??[];for(const L of I){const A=en(L.name);let N=T.tag.get(A.group);N===void 0&&(N=new Set,T.tag.set(A.group,N)),N.add(A.value)}}o.setSuccess({countAllFetchedTrans:n.length,countPlaidMetadataObjectsParsed:l,note:"(Not all transactions have Plaid Metadata, e.g., groups, split transactions, transactions imported form sources other than Plaid...)"})}catch(l){o.setFailureAndRethrow(l)}return a.setSuccess(),r}catch(n){return a.setFailureAndRethrow(n)}}async function Ms(e,t,a,n){const s=ae().startOperation("Apply formatting to table columns");let o=null;try{for(let r=0;r<t.length;r++){r%30===0&&(o?.setSuccess(),o=ae().startOperation(`Format table columns ${r}...${r+30}, out of ${t.length}`));const d=t[r],c=e.columns.getItemAt(r),w=a.getByKey(d);if(w===void 0)continue;const T=w.numberFormat,y=w.formatFn;if(T===null&&y===null)continue;const k=c.getDataBodyRange();if(T&&(k.numberFormat=[[T]]),y)try{await y(k.format,k.dataValidation,n),await n.excel.sync()}catch(I){const L=`The formatFn of the column spec for '${d}' threw an error
(${xe(I)})
We will skip over this and continue, but this needs to be corrected.`;o?.addInfo(L,I),s.addInfo(L,I)}}await n.excel.sync(),o?.setSuccess(),s.setSuccess()}catch(r){o?.setFailure(r),s.setFailureAndRethrow(r)}}async function Fs(e,t){const a=e.getRange();a.load(["address","rowIndex","columnIndex","name"]),await t.excel.sync();const n={row:a.rowIndex-2,col:a.columnIndex},s=Y(t.sheets.trans,n,0,0,1,1);s.format.fill.clear(),s.format.font.color="#7e350e",s.format.font.bold=!0,s.format.horizontalAlignment="Right",s.values=[["Count:"]];const o=Y(t.sheets.trans,n,0,1,1,1);o.format.fill.color="#f2f2f2",o.format.font.color="#7e350e",o.format.font.bold=!0,o.format.horizontalAlignment="Left",o.formulas=[[`="  " & COUNTA(${e.name}[${_e.LunchId}])`]];const r=Y(t.sheets.trans,n,0,3,1,1);r.format.fill.clear(),r.format.font.color="#7e350e",r.format.font.bold=!0,r.format.horizontalAlignment="Right",r.values=[["Last completed download data version / time:"]];const l=Y(t.sheets.trans,n,0,4,1,1);l.format.fill.color="#f2f2f2",l.format.font.color="#7e350e",l.format.font.bold=!0,l.format.horizontalAlignment="Left",l.formulas=[[`="  " & "${t.currentSync.version}"`]];const d=Y(t.sheets.trans,n,0,5,1,1);d.format.fill.color="#f2f2f2",d.format.font.color="#7e350e",d.format.font.bold=!0,d.format.horizontalAlignment="Left",d.values=[[Ga(t.currentSync.utc,!0)]],d.numberFormat=[["  yyyy-mm-dd  HH:mm:ss"]],await t.excel.sync()}async function Vs(e,t,a){const n=ta(31,90,a);n.setPercentage(0),a.sheets.trans.activate(),await a.excel.sync();const s=a.sheets.trans.getRange("B5:F5");s.clear();const o=s.getCell(0,0);await a.excel.sync();const r=ae().startOperation("Download Transactions");try{n.setPercentage(5),await Is(a);const l=As(a);a.sheets.trans.getRange("A:A").format.columnWidth=15,await a.excel.sync();const d=await wt(Wt,a.sheets.trans,a.excel),c=d===null?await Es(l,a.sheets.trans,a.excel):d.table;await Ps(c,a);{a.sheets.trans.freezePanes.unfreeze(),await a.excel.sync();const v=c.getHeaderRowRange();v.load(["rowIndex"]),await a.excel.sync(),a.sheets.trans.freezePanes.freezeRows(v.rowIndex+1),await a.excel.sync()}const w=ae().startOperation("Load Transactions table column names");try{c.columns.load(["count","items"]),await a.excel.sync();for(const v of c.columns.items)v.load("name");await a.excel.sync(),w.setSuccess()}catch(v){w.setFailureAndRethrow(v)}const T=c.columns.items.map(v=>v.name.trim());if(await qs(c,T,a),!T.includes(_e.LunchId))throw new Error(`Table '${c.name}' (${d===null?"newly created":"pre-existing"}) does not contain the expected column '${_e.LunchId}'.`);if(!Os(l,T))throw new Error(`Columns in table '${Wt}' do not match expected transaction header structure. Try deleting the entire table.`);n.setPercentage(10);const y=ae().startOperation("Delete empty rows from the Transactions table");try{const v=c.getDataBodyRange();c.rows.load(["count"]),v.load("values"),await a.excel.sync();const C=c.rows.count,f=v.values;let x=0;for(let q=f.length-1;q>=0;q--){if(q===0&&x===C-1)continue;f[q].every(g=>he(g))&&(c.rows.getItemAt(q).delete(),x++)}c.rows.load(["count","items"]),await a.excel.sync(),y.setSuccess({countEmptyRowsDeleted:x})}catch(v){y.setFailureAndRethrow(v)}n.setPercentage(15);const k=await $s(c,T,a);n.setPercentage(30);const I=await Ls(e,t);n.setPercentage(60);const L=[],A=ae().startOperation("Merge received and existing transactions");let N=null;try{const v=T.findIndex(f=>f===_e.LastSyncVersion),C={sameAsReceived:0,differentFromReceived:0,notComparedWithReceived:0};for(let f=0;f<I.length;f++){f%250===0&&(N?.setSuccess(),N=ae().startOperation(`Merge transactions ${f}...${f+250}, out of ${I.length}`));const q=I.getByIndex(f);if(q===void 0)continue;const z=k.getByKey(q.id);if(z!==void 0){if(!a.isUpdateExistingTransactions){C.notComparedWithReceived++;continue}z.load(["values","formulas"]),await a.excel.sync();const m=z.values[0],g=z.formulas[0];let R=!1;for(let S=0;S<m.length;S++){if(S===v)continue;const u=T[S],i=m[S],_=Oa(q,u,l);i!==_&&(typeof i=="number"&&typeof _=="string"&&Number(_.trim())===i||(g[S]===_?m[S]=g[S]:(m[S]=_,R=!0)))}R?(m[v]=a.currentSync.version,z.values=[m],C.differentFromReceived++,await a.excel.sync()):C.sameAsReceived++}else{const m=[];for(const g of T)g===_e.LastSyncVersion?m.push(a.currentSync.version):m.push(Oa(q,g,l));L.push(m)}}N?.setSuccess(),A.setSuccess({countReceivedTrans:I.length,isReplaceExistingTrans:a.isUpdateExistingTransactions,countExistingTransFound:C,countTranRowsToAdd:L.length})}catch(v){N?.setFailure(v),A.setFailureAndRethrow(v)}n.setPercentage(67);const Q=ae().startOperation("Insert rows into Transactions table",{rowCount:L.length});try{let C=0;for(;C<L.length;){const f=ae().startOperation(`Insert rows ${C}...${C+250} of ${L.length}`);try{const x=L.slice(C,C+250);c.rows.add(0,x),await a.excel.sync(),C+=250,f.setSuccess()}catch(x){f.setFailureAndRethrow(x)}}Q.setSuccess()}catch(v){Q.setFailureAndRethrow(v)}n.setPercentage(75);const $=ae().startOperation("Sort the Transactions table");try{const v=[{key:T.findIndex(C=>C==="date"),sortOn:Excel.SortOn.value,ascending:!1},{key:T.findIndex(C=>C==="plaid:authorized_datetime"),sortOn:Excel.SortOn.value,ascending:!1},{key:T.findIndex(C=>C==="Account"),sortOn:Excel.SortOn.value,ascending:!0},{key:T.findIndex(C=>C==="Payer"),sortOn:Excel.SortOn.value,ascending:!0},{key:T.findIndex(C=>C==="payee"),sortOn:Excel.SortOn.value,ascending:!0},{key:T.findIndex(C=>C==="plaid:datetime"),sortOn:Excel.SortOn.value,ascending:!1},{key:T.findIndex(C=>C===_e.LunchId),sortOn:Excel.SortOn.value,ascending:!0}].filter(C=>C.key>=0);c.sort.apply(v),await a.excel.sync(),$.setSuccess()}catch(v){$.setFailureAndRethrow(v)}n.setPercentage(80),await Ms(c,T,l,a),n.setPercentage(90),await Fs(c,a),c.getRange().format.autofitColumns(),await a.excel.sync(),n.setPercentage(100),r.setSuccess()}catch(l){o.values=[[`ERR: ${xe(l)}`]],o.format.font.color="#FF0000",await a.excel.sync(),r.setFailureAndRethrow(l)}}let zt=!1;async function Bs(e,t,a,n){const s=De();if(zt===!0)throw new Error("Cannot start data download, because data sync is already in progress.");const o=s.tracker.startOperation("Download Data",{updateExistingTransactions:a});o.addInfo({startDate:e,endDate:t}),e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()&&(t.setDate(t.getDate()+1),o.addInfo("Moved End Date one day later to work about a Lunch Money bug",{startDate:e,endDate:t}));let r=!0;try{zt=!0,r=De().isImportantOperationOngoing.value,s.setImportantOperationOngoing(!0);const l=await ea(),d={version:l.lastCompletedSyncVersion.value+1,utc:new Date};{const c=l.apiToken.value;if(he(c)){o.setFailure("No API token. Cannot proceed with download");return}o.addInfo(`downloadData(..): has API token (${c.length} chars).`)}await Excel.run(async c=>{const w=await Vt(Rs,c),T=await Vt(ys,c),y=await Vt(Ts,c),k={excel:c,currentSync:d,isUpdateExistingTransactions:a,progressPercentage:n,sheets:{trans:w,tags:T,cats:y},tags:{assignable:new Map,groupListFormulaLocations:new Map,byId:new Map},cats:{assignable:new rt,listFormulaLocation:null}};await _s(k),await Ss(k),await Vs(e,t,k)}),l.lastCompletedSyncUtc.value=d.utc,l.lastCompletedSyncVersion.value=d.version,o.setSuccess()}catch(l){o.setFailureAndRethrow(l)}finally{n.value=100,s.setImportantOperationOngoing(r),zt=!1}}let Nt=!1;function Ds(e){if(he(e))return"<empty>";const t=e.length;return t<9?`(${t} chars)`:e.substring(0,3)+"..."+e.substring(e.length-3)+` (${t} chars)`}async function zs(e){const t=De();if(Nt===!0)return{isValid:!1,info:`Cannot validate token:
 Validation already in progress.`};const a=Ds(e),n=t.tracker.startOperation("Validate API Token",a);try{if(Nt=!0,he(e)){const w="Specified API token is empty.";return n.setFailure(w),{isValid:!1,info:w}}const s=new Headers;s.append("Authorization",`Bearer ${e}`);const r=await fetch("https://dev.lunchmoney.app/v1/me",{method:"GET",headers:s,redirect:"follow"});if(r.status===401){const w="Specified API token does not exist or is not valid.";return n.setFailure(w),{isValid:!1,info:w}}const l=r.ok?await r.text():await At("GET","me","get API token user info"),d=JSON.parse(l);if(d===void 0&&d===null)throw new Error("Cannot parse API token's user info");const c=w=>{if(!(w in d))throw new Error(`API token's user info fetched and parsed, but it does not contain '${w}'.`)};return c("user_name"),c("user_email"),c("user_id"),c("account_id"),c("budget_name"),c("primary_currency"),c("api_key_label"),n.setSuccess(),{isValid:!0,info:d}}catch(s){return n.setFailure(s),{isValid:!1,info:xe(s)}}finally{Nt=!1}}const Ns={class:"text-left q-gutter-md",style:{width:"fit-content"}},Us={key:0,class:"q-pa-sm form-group-border",style:{"font-size":"smaller",color:"red",width:"auto"}},Hs={key:1,class:"q-pa-sm form-group-border",style:{"font-size":"smaller",width:"auto"}},js={class:"q-pa-sm form-group-border",style:{width:"auto"}},Ks={style:{padding:"0",margin:"0px","text-align":"right"}},Qs={class:"q-pa-sm form-group-border",style:{width:"auto"}},Ws={class:"q-mb-sm"},Gs={class:"date-inputs",style:{display:"flex",gap:"16px"}},Ys={style:{"max-width":"220px",width:"100%"}},Xs={key:0,class:"text-negative q-mt-xs"},Zs={style:{"max-width":"220px",width:"100%"}},Js={key:0,class:"text-negative q-mt-xs"},er={class:"q-pa-sm form-group-border",style:{width:"auto"}},tr={class:"q-pa-sm q-mt-md q-mb-sm form-group-border",style:{"font-size":"smaller",width:"auto"}},ar={key:0},nr={key:0},or={key:1},sr=kt({__name:"SyncTab",setup(e){const t=B(""),a=B(null);let n;const s=B(""),o=B(!1),r=B("API token not verified."),l=B(void 0),d=B(!1),c=O(()=>d.value===!0?"Token is being verified...":l.value===void 0?"Token not verified."+(o.value?"":" Expand to configure."):l.value?"Token is valid":"Token not valid."+(o.value?"":" Expand to configure.")),w=B(!1),T=B(!1),y=O({get:()=>T.value,set:u=>{u?w.value=!0:T.value=!1}});async function k(u){d.value=!0;try{r.value="API token is being verified.",l.value=!1;const{isValid:i,info:_}=await zs(u);return i?r.value=`Token is valid.
 Token moniker:    ${_.api_key_label??"<Not Named>"}
 Grants access to: ${_.budget_name??"<Unnamed Budget>"}
 User:             ${_.user_name??"Unnamed User"} (${_.user_email??"NoEmail"})`:r.value=_,l.value=i,i}finally{d.value=!1}}async function I(){const u=(s.value??"").trim();if(r.value="API token not verified.",l.value=!1,!y.value)try{await n.clearTokenStorage()}catch(_){console.error("Error removing the API token from the document!",_)}const i=await k(u);try{n.apiToken.value=u,y.value&&await n.storeApiToken()}catch(_){console.error("Error setting or storing API token in App Settings.",_)}return i?u:void 0}function L(u){u==="yes"&&(T.value=!0),w.value=!1}const A=Fn({lastSync:null,recent:null,last24Months:null});function N(u){if(u.getDate()>=1&&u.getDate()<=19){const i=new Date(u.getFullYear(),u.getMonth()-1,1);return Ye(i)}else{const i=new Date(u.getFullYear(),u.getMonth(),1);return Ye(i)}}function Q(u){const E=new Date(u.getTime()-63072e6);return Ye(E)}function $(){const u=new Date,i=Ye(u),_=n.lastCompletedSyncUtc.value;A.lastSync=_===null?null:{start:Ye(_),end:i},A.recent={start:N(u),end:i},A.last24Months={start:Q(u),end:i}}function v(u){u!==null&&(z.value=u.start,m.value=u.end)}const C=u=>u?new Date(u).getUTCFullYear()>=2010||"YEAR must be 2010 or later.":!0,f=B(-1),x=O(()=>{const u=0<=f.value&&f.value<100,i=d.value===!0;return u||i}),q=B(!1),z=B(""),m=B(""),g=B(""),R=B("");async function S(){g.value="",R.value="";let u=z.value,i=m.value;if(he(u))g.value="Please select a START date.";else{const F=C(u);g.value=F===!0?"":"date too old"}if(he(i))R.value="Please select an END date.";else{const F=C(i);R.value=F===!0?"":"date too old"}if(!he(g.value)||!he(R.value))return;let _=new Date(u),E=new Date(i);if(_>E){const F=u;z.value=u=i,m.value=i=F,_=new Date(u),E=new Date(i)}if(g.value||R.value)return;if(await I()===void 0){o.value=!0;return}const h=q.value;try{f.value=0;try{await Bs(_,E,h,f),po("Data download complete"),$()}catch(F){vo("Error while downloading data! (see status log for details)",xe(F))}}finally{f.value=-1}}return Qe(async()=>{const u=ae().startOperation("ExpLens Excel-AddIn: SyncData Tab mounted. Getting Office API ready...");try{try{a.value=await Qa(!0)}catch(E){E instanceof Error?t.value=E.message:t.value="Unexpected error while getting office APIs ready: "+co(E),u.setFailure("Error getting office APIs ready. AddIn will not work!",{message:t.value,error:E}),console.error("Error getting office APIs ready. AddIn will not work!",{message:t.value,error:E});return}t.value="",n=await ea();const i=n.apiToken.value??"";s.value=i,T.value=i.length>0;const _=await k(i);o.value=!_,J(n.apiToken,async E=>{const h=E??"";s.value!==h&&(s.value=h,await k(h))}),$(),v(A.lastSync??A.recent),u.setSuccess()}catch(i){u.setFailureAndRethrow(i)}}),(u,i)=>(de(),we(Bn,null,[H("div",Ns,[i[21]||(i[21]=H("h2",{class:"q-ma-md tab-main-header"},"Synchronize Bank Data",-1)),t.value?(de(),we("div",Us,ce(t.value),1)):Ee("",!0),be(he)(t.value)&&a.value===null?(de(),we("div",Hs," Office Add-In environment not initialized (yet?). ")):Ee("",!0),H("div",js,[K(fo,{id:"api-token-expansion",modelValue:o.value,"onUpdate:modelValue":i[2]||(i[2]=_=>o.value=_),label:"Lunch Money Access Token",caption:o.value?"":c.value,dense:"","dense-toggle":""},{default:te(()=>[K(be(Ft),{modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=_=>s.value=_),disable:x.value,filled:"",label:"API Token",dense:"",counter:!1,maxlength:"200",style:{"max-width":"450px",width:"100%",padding:"0 10px 20px 0"}},null,8,["modelValue","disable"]),K(Fo,{modelValue:y.value,"onUpdate:modelValue":i[1]||(i[1]=_=>y.value=_),disable:x.value,style:{"font-size":"smaller","line-height":"normal"}},{default:te(()=>[...i[14]||(i[14]=[ie("Store the API Token in the current document",-1),H("br",null,null,-1),H("span",{style:{"font-size":"smaller"}},"(Unsecure!)",-1)])]),_:1},8,["modelValue","disable"]),H("div",Ks,[K(Pe,{label:"Apply",disable:x.value,color:"primary",onClick:I,class:"q-ma-sm",dense:"","no-caps":""},null,8,["disable"])]),H("pre",{class:"q-ma-xs",style:Vn({fontFamily:"monospace",fontSize:"10px",lineHeight:1,color:!d.value&&!l.value?"red":"black"})},ce(r.value),5)]),_:1},8,["modelValue","caption"])]),H("div",Qs,[i[16]||(i[16]=H("div",{class:"text-weight-bold q-mb-xs",style:{"font-size":"0.9rem"}},"Download transactions for dates:",-1)),H("div",Ws,[i[15]||(i[15]=H("div",{class:"text-primary text-weight-bold q-mb-xs",style:{"font-size":"0.7rem"}},"Quick select:",-1)),K(Pe,{color:"primary",outline:"","no-wrap":"","no-caps":"",dense:"",label:"Since Last Sync",class:"q-mr-xs",disable:x.value||A.lastSync===null,onClick:i[3]||(i[3]=_=>v(A.lastSync))},{default:te(()=>[A.lastSync?(de(),mt(je,{key:0,anchor:"top middle",self:"bottom middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[ie(ce(A.lastSync?.start)+" ... "+ce(A.lastSync?.end),1)]),_:1})):Ee("",!0)]),_:1},8,["disable"]),K(Pe,{color:"primary",outline:"","no-wrap":"","no-caps":"",dense:"",label:"Recent",class:"q-mr-xs",disable:x.value||A.recent===null,onClick:i[4]||(i[4]=_=>v(A.recent))},{default:te(()=>[A.recent?(de(),mt(je,{key:0,anchor:"top middle",self:"bottom middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[ie(ce(A.recent?.start)+" ... "+ce(A.recent?.end),1)]),_:1})):Ee("",!0)]),_:1},8,["disable"]),K(Pe,{color:"primary",outline:"","no-wrap":"","no-caps":"",dense:"",label:"Last 24 months",disable:x.value||A.last24Months===null,onClick:i[5]||(i[5]=_=>v(A.last24Months))},{default:te(()=>[A.last24Months?(de(),mt(je,{key:0,anchor:"top middle",self:"bottom middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[ie(ce(A.last24Months?.start)+" ... "+ce(A.last24Months?.end),1)]),_:1})):Ee("",!0)]),_:1},8,["disable"])]),H("div",Gs,[H("div",Ys,[K(be(Ft),{disable:x.value,filled:"",label:"START",modelValue:z.value,"onUpdate:modelValue":[i[6]||(i[6]=_=>z.value=_),i[7]||(i[7]=_=>g.value="")],type:"date",error:!!g.value,rules:[C]},null,8,["disable","modelValue","error","rules"]),g.value?(de(),we("div",Xs,ce(g.value),1)):Ee("",!0)]),H("div",Zs,[K(be(Ft),{disable:x.value,filled:"",label:"END",modelValue:m.value,"onUpdate:modelValue":[i[8]||(i[8]=_=>m.value=_),i[9]||(i[9]=_=>g.value="")],type:"date",error:!!R.value,rules:[C]},null,8,["disable","modelValue","error","rules"]),R.value?(de(),we("div",Js,ce(R.value),1)):Ee("",!0)])]),i[17]||(i[17]=H("div",{class:"text-weight-bold q-mb-xs",style:{"font-size":"0.9rem"}},"Download method:",-1)),K(go,{modelValue:q.value,"onUpdate:modelValue":i[10]||(i[10]=_=>q.value=_),disable:x.value,color:"indigo-3","toggle-color":"indigo-6",unelevated:"","no-wrap":"","no-caps":"",dense:"",options:[{value:!0,label:"Overwrite Existing",icon:"note_alt"},{value:!1,label:"Download New Only",icon:"note_add"}]},null,8,["modelValue","disable"]),K(jt,{class:"q-ma-sm q-mt-md q-mb-md",color:"grey-6"}),K(Pe,{icon:q.value?"note_alt":"note_add",label:"Download",loading:x.value,percentage:f.value,color:"primary",onClick:S,class:"q-ma-xs block q-mx-auto"},null,8,["icon","loading","percentage"])]),H("div",er,[i[18]||(i[18]=H("div",{class:"text-weight-bold text-grey-6 q-mb-xs",style:{"font-size":"0.9rem"}},"Upload transactions:",-1)),i[19]||(i[19]=H("div",{class:"text-weight-bold text-grey-6 q-mb-sm",style:{"font-size":"0.7rem"}},[ie(" Only modifications to Categories and Tags will be uploaded."),H("br"),ie(" ("),H("span",{style:{"background-color":"#b5e6a2",color:"#4ea72e"}},"columns with green on top"),ie(") ")],-1)),i[20]||(i[20]=H("div",{class:"q-mb-md text-grey-8",style:{"font-size":"0.9rem"}},"Supported in future versions.",-1)),K(jt,{class:"q-ma-sm q-mt-md q-mb-md",color:"grey-4"}),K(Pe,{disable:"",icon:"cloud_upload",label:"Upload",loading:x.value,percentage:f.value,color:"grey-6",class:"q-ma-xs block q-mx-auto"},null,8,["loading","percentage"])]),H("div",tr,[a.value?(de(),we("div",ar,[H("div",null," Connected to MS Office. Host: '"+ce(a.value.host??"null")+"'; Platform: '"+ce(a.value.platform??"null")+"'. ",1),be(n)?(de(),we("div",nr," Last sync: "+ce(be(n).lastCompletedSyncUtc.value?be(mo)(be(n).lastCompletedSyncUtc.value):"never")+" (#"+ce(be(n).lastCompletedSyncVersion.value)+"). ",1)):Ee("",!0)])):(de(),we("div",or,"Office Add-In environment not initialized (yet?)."))])]),K(Qo,{modelValue:w.value,"onUpdate:modelValue":i[13]||(i[13]=_=>w.value=_),persistent:""},{default:te(()=>[K(Do,null,{default:te(()=>[K(Vo,null,{default:te(()=>[...i[22]||(i[22]=[H("div",{class:"text-weight-bold q-mb-sm",style:{"font-size":"larger"}}," Really store the API Token as clear text in this document? ",-1),H("p",{class:"text-weight-bold"},"Anybody who can access this document can also access the token.",-1),H("p",{class:"text-justify q-mb-xs"},[ie(" The API Token enables complete access to all your data inside of Lunch Money."),H("br"),ie(" We can store the API Token in the current document for your convenience. However, the Token is not encrypted, and anybody with access to this document can theoretically also access the Token. ")],-1),H("p",{class:"text-justify q-mb-xs"},[ie(" If you ever suspect that an unauthorized person accessed your API Token, you must immediately delete it (you can create a new one right away). To do that, go to "),H("span",{class:"text-italic"},"Settings > Developers"),ie(" in your Lunch Money app."),H("br"),ie(" ("),H("a",{target:"_blank",href:"https://my.lunchmoney.app/developers"},"https://my.lunchmoney.app/developers"),ie("). ")],-1)])]),_:1}),K(Bo,{align:"right"},{default:te(()=>[Ut(K(Pe,{flat:"",label:"No",color:"positive",onClick:i[11]||(i[11]=_=>L("no"))},null,512),[[pa]]),Ut(K(Pe,{flat:"",label:"Yes",color:"negative",onClick:i[12]||(i[12]=_=>L("yes"))},null,512),[[pa]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),rr={class:"text-left q-gutter-md"},lr=kt({__name:"AnalyzeTab",setup(e){return(t,a)=>(de(),we("div",rr,[...a[0]||(a[0]=[H("h2",{class:"q-ma-md tab-main-header"},"Analyze Transactions",-1),H("p",null,"This function is not yet available in the current preview version.",-1),H("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. ",-1)])]))}}),ir={class:"text-left q-gutter-md"},ur=kt({__name:"SettingsTab",setup(e){return(t,a)=>(de(),we("div",ir,[...a[0]||(a[0]=[H("h2",{class:"q-ma-md tab-main-header"},"App Settings",-1),H("p",null,"This function is not yet available in the current preview version.",-1),H("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. ",-1)])]))}}),cr="0.1.0-alpha",dr={class:"main-content q-pa-md"},fr={class:"title-bar"},gr={class:"title-version"},mr=kt({__name:"IndexPage",setup(e){console.debug("ExpLens Excel-AddIn: Loading IndexPage..."),Qe(async()=>{});const t=B("sync");return(a,n)=>(de(),mt(Lo,{class:"row justify-center"},{default:te(()=>[H("div",dr,[H("div",fr,[n[2]||(n[2]=H("h1",{class:"title-name"},"ExpLens",-1)),H("div",gr,ce(be(cr)),1),n[3]||(n[3]=H("img",{src:"/icons/favicon-32x32.png",alt:"Logo",class:"title-logo"},null,-1))]),K(So,{modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=s=>t.value=s),"inline-label":"",align:"center",class:"q-mb-md","indicator-color":"tab-bar-active"},{default:te(()=>[K(It,{name:"sync"},{default:te(()=>[K(Te,{name:"currency_exchange",size:"sm"}),K(je,{anchor:"bottom middle",self:"top middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[...n[4]||(n[4]=[ie(" Synchronize Bank Data ",-1)])]),_:1})]),_:1}),K(It,{name:"analyze"},{default:te(()=>[K(Te,{name:"analytics",size:"sm"}),K(je,{anchor:"bottom middle",self:"top middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[...n[5]||(n[5]=[ie(" Analyze Transactions ",-1)])]),_:1})]),_:1}),K(It,{name:"settings"},{default:te(()=>[K(Te,{name:"settings",size:"sm"}),K(je,{anchor:"bottom middle",self:"top middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[...n[6]||(n[6]=[ie(" App Settings ",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),K(jt,{class:"q-mb-sm"}),K($o,{modelValue:t.value,"onUpdate:modelValue":n[1]||(n[1]=s=>t.value=s),"keep-alive":"",animated:""},{default:te(()=>[K(qt,{name:"sync",class:"q-pa-none"},{default:te(()=>[K(sr)]),_:1}),K(qt,{name:"analyze",class:"q-pa-none"},{default:te(()=>[K(lr)]),_:1}),K(qt,{name:"settings",class:"q-pa-none"},{default:te(()=>[K(ur)]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}}),yr=ho(mr,[["__scopeId","data-v-168d71bd"]]);export{yr as default};
